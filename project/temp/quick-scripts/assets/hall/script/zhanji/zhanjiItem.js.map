{"version":3,"sources":["zhanjiItem.js"],"names":["cc","Class","extends","Component","properties","ownNameColor","default","Color","WHITE","displayName","otherNameColor","addScoreColor","subScoreColor","maxUser","infoBtn","type","Node","juShuLabel","Label","timeLabel","roomNumLabel","detailPre","Prefab","onLoad","on","onInfoBtnClick","_padZero","num","init","data","_selfId","fun","db","getData","UserId","_gameType","gameType","time","Date","createdAt","month","getMonth","day","getDate","hours","getHours","minutes","getMinutes","timeStr","getFullYear","string","roomId","_uid","id","_data","i","head","node","getChildByName","nameNode","players","getComponent","userName","utils","loadUrlRes","headUrl","userId","color","cascadeOpacity","opacity","score","scoreNode","active","require","playEffect","net","pSend","GameType","Id","detailNode","instantiate","parent","director","getScene","accounts","bind"],"mappings":"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","file":"zhanjiItem.js","sourceRoot":"../../../../../../assets/hall/script/zhanji","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        ownNameColor: {\n            default: cc.Color.WHITE,\n            displayName: '自己名字颜色',\n        },\n\n        otherNameColor: {\n            default: cc.Color.WHITE,\n            displayName: '别人名字颜色',\n        },\n\n        addScoreColor: {\n            default: cc.Color.WHITE,\n            displayName: '加分颜色',\n        },\n\n        subScoreColor: {\n            default: cc.Color.WHITE,\n            displayName: '减分颜色',\n        },\n\n        maxUser: {\n            default: 4,\n            displayName: '最多玩家数',\n        },\n\n        infoBtn: {\n            type: cc.Node,\n            default: null,\n        },\n\n        juShuLabel: {\n            type: cc.Label,\n            default: null,\n        },\n\n        timeLabel: {\n            type: cc.Label,\n            default: null,\n        },\n\n        roomNumLabel: {\n            type: cc.Label,\n            default: null,\n        },\n\n        detailPre: {\n            type: cc.Prefab,\n            default: null,\n        },\n    },\n\n    onLoad() {\n        this.infoBtn.on('click', this.onInfoBtnClick, this);\n    },\n\n    _padZero(num) {\n        if (num < 10) {\n            num = \"0\" + num;\n        }\n        return num;\n    },\n\n    init(data) {\n        this._selfId = fun.db.getData('UserInfo').UserId;        \n        this._gameType = data.gameType;\n        let time = new Date(data.createdAt * 1000);//value.deletedAt\n        const month = this._padZero(time.getMonth() + 1);\n        const day = this._padZero(time.getDate());\n        const hours = this._padZero(time.getHours());\n        const minutes = this._padZero(time.getMinutes());\n        data.timeStr = `${time.getFullYear()}.${month}.${day} ${hours}:${minutes}`;\n        this.timeLabel.string = data.timeStr;\n        this.roomNumLabel.string = data.roomId;\n        this._uid = data.id;\n        this._data = data;\n\n        for (let i = 0; i < this.maxUser; i++) {\n            let head = this.node.getChildByName('head' + (i + 1));\n            let nameNode = head.getChildByName('name');\n            if (data.players[i]) {\n                nameNode.getComponent(cc.Label).string = data.players[i].userName;\n                fun.utils.loadUrlRes(data.players[i].headUrl, head.getChildByName('icon'));\n                if (this._selfId === data.players[i].userId) {\n                    nameNode.color = this.ownNameColor;\n                } else {\n                    head.cascadeOpacity = false;\n                    head.opacity = 0;\n                    nameNode.color = this.otherNameColor;\n                }\n                const score = data.players[i].score || 0;\n                let scoreNode = head.getChildByName('fenshu');\n                scoreNode.getComponent(cc.Label).string = score;\n                if (score >= 0) {\n                    scoreNode.color = this.addScoreColor;\n                } else {\n                    scoreNode.color = this.subScoreColor;\n                }\n            } else {\n                head.active = false;\n            }\n        }        \n    },\n\n    onInfoBtnClick() {\n        require('Audio').playEffect('hall', 'button_nomal.mp3');\n        fun.net.pSend('StandingDetail', {GameType: this._gameType, Id: this._uid}, function(data) {\n            let detailNode = cc.instantiate(this.detailPre);\n            detailNode.parent = cc.director.getScene().getChildByName('Canvas');\n            detailNode.getComponent('zhanjiDetail').init(data.accounts, this._data);\n        }.bind(this));\n    },\n});\n"]}
{"version":3,"sources":["hallEnterNum.js"],"names":["GameCfg","require","Audio","PanelType","cc","Enum","enterRoom","viewPlayback","Class","extends","Component","properties","panelType","type","default","onLoad","bg","node","getChildByName","targetNum","on","onBtnCloseClick","onBtnCleanClick","onBtnReenterClick","enterNumber","maxNum","childrenCount","numberEnter","i","active","numBtns","onNumBtnClick","bind","animation","getComponent","Animation","clips","getClips","onEnable","play","name","playEffect","once","onAnimationFinished","destroy","forEach","v","length","pop","getRoomIdByArray","arr","roomid","num","parseInt","Label","string","push","rId","fun","event","dispatch","flag","text","net","pSend","Code","data","RetCode","db","setData"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,QAAQD,QAAQ,OAAR,CAAZ;AACA,IAAME,YAAYC,GAAGC,IAAH,CAAQ;AACtBC,eAAW,CADW;AAEtBC,kBAAc;AAFQ,CAAR,CAAlB;;AAMAH,GAAGI,KAAH,CAAS;AACLC,aAASL,GAAGM,SADP;;AAGLC,gBAAY;AACRC,mBAAW;AACPC,kBAAMV,SADC;AAEPW,qBAASX,UAAUG;AAFZ;AADH,KAHP;;AAULS,UAVK,oBAUK;AACN,YAAIC,KAAK,KAAKC,IAAL,CAAUC,cAAV,CAAyB,MAAzB,CAAT;AACA,aAAKC,SAAL,GAAiB,EAAjB;AACAH,WAAGE,cAAH,CAAkB,UAAlB,EAA8BE,EAA9B,CAAiC,OAAjC,EAA0C,KAAKC,eAA/C,EAAgE,IAAhE;AACAL,WAAGE,cAAH,CAAkB,UAAlB,EAA8BE,EAA9B,CAAiC,OAAjC,EAA0C,KAAKE,eAA/C,EAAgE,IAAhE;AACAN,WAAGE,cAAH,CAAkB,YAAlB,EAAgCE,EAAhC,CAAmC,OAAnC,EAA4C,KAAKG,iBAAjD,EAAoE,IAApE;AACA,YAAIC,cAAcR,GAAGE,cAAH,CAAkB,aAAlB,CAAlB;AACA,aAAKO,MAAL,GAAcD,YAAYE,aAA1B;AACA,aAAKC,WAAL,GAAmB,EAAnB;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKH,MAAzB,EAAiCG,GAAjC,EAAsC;AAClC,iBAAKD,WAAL,CAAiBC,CAAjB,IAAsBJ,YAAYN,cAAZ,CAA2B,UAAUU,IAAE,CAAZ,CAA3B,EAA2CV,cAA3C,CAA0D,SAA1D,CAAtB;AACA,iBAAKS,WAAL,CAAiBC,CAAjB,EAAoBC,MAApB,GAA6B,KAA7B;AACH;AACD,YAAIC,UAAUd,GAAGE,cAAH,CAAkB,SAAlB,CAAd;AACA,aAAK,IAAIU,KAAI,CAAb,EAAgBA,KAAI,EAApB,EAAwBA,IAAxB,EAA6B;AACzBE,oBAAQZ,cAAR,CAAuB,WAAWU,EAAlC,EAAqCR,EAArC,CAAwC,OAAxC,EAAiD,KAAKW,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,EAA8BJ,EAA9B,CAAjD;AACH;;AAED,aAAKK,SAAL,GAAiB,KAAKhB,IAAL,CAAUiB,YAAV,CAAuB9B,GAAG+B,SAA1B,CAAjB;AACA,aAAKC,KAAL,GAAa,KAAKH,SAAL,CAAeI,QAAf,EAAb;AACH,KA9BI;AAgCLC,YAhCK,sBAgCO;AACR,aAAKL,SAAL,CAAeM,IAAf,CAAoB,KAAKH,KAAL,CAAW,CAAX,EAAcI,IAAlC;AACH,KAlCI;AAoCLnB,mBApCK,6BAoCa;AACdnB,cAAMuC,UAAN,CAAiB,MAAjB,EAAyB,kBAAzB;AACA,aAAKR,SAAL,CAAeM,IAAf,CAAoB,KAAKH,KAAL,CAAW,CAAX,EAAcI,IAAlC,EAAwCE,IAAxC,CAA6C,UAA7C,EAAyD,KAAKC,mBAA9D,EAAmF,IAAnF;AACH,KAvCI;AAyCLA,uBAzCK,iCAyCkB;AACnB,YAAI,KAAK/B,SAAL,KAAmBT,UAAUI,YAAjC,EAA+C;AAC3C,iBAAKU,IAAL,CAAU2B,OAAV;AACH,SAFD,MAEO;AACH,iBAAKzB,SAAL,GAAiB,EAAjB;AACA,iBAAKQ,WAAL,CAAiBkB,OAAjB,CAAyB,UAAUC,CAAV,EAAa;AAClCA,kBAAEjB,MAAF,GAAW,KAAX;AACH,aAFD;AAGA,iBAAKZ,IAAL,CAAUY,MAAV,GAAmB,KAAnB;AACH;AACJ,KAnDI;AAqDLP,mBArDK,6BAqDa;AACdpB,cAAMuC,UAAN,CAAiB,MAAjB,EAAyB,kBAAzB;AACA,YAAI,KAAKtB,SAAL,CAAe4B,MAAf,IAAyB,CAA7B,EAAgC;AAC5B;AACH;AACD,aAAK5B,SAAL,CAAe6B,GAAf;AACA,aAAKrB,WAAL,CAAiB,KAAKR,SAAL,CAAe4B,MAAhC,EAAwClB,MAAxC,GAAiD,KAAjD;AACH,KA5DI;AA8DLN,qBA9DK,+BA8De;AAChBrB,cAAMuC,UAAN,CAAiB,MAAjB,EAAyB,kBAAzB;AACA,aAAKtB,SAAL,GAAiB,EAAjB;AACA,aAAKQ,WAAL,CAAiBkB,OAAjB,CAAyB,UAAUC,CAAV,EAAa;AAClCA,cAAEjB,MAAF,GAAW,KAAX;AACH,SAFD;AAGH,KApEI;AAsELoB,oBAtEK,4BAsEYC,GAtEZ,EAsEiB;AAClB,YAAIC,SAAS,EAAb;AACAD,YAAIL,OAAJ,CAAY,UAASO,GAAT,EAAa;AACrBD,sBAAUC,GAAV;AACH,SAFD;AAGA,eAAOC,SAASF,MAAT,CAAP;AACH,KA5EI;AA8ELpB,iBA9EK,yBA8ESqB,GA9ET,EA8Ec;AACflD,cAAMuC,UAAN,CAAiB,MAAjB,EAAyB,kBAAzB;AACA,YAAI,KAAKtB,SAAL,CAAe4B,MAAf,IAAyB,KAAKtB,MAAlC,EAA0C;AACtC;AACH;AACD,aAAKE,WAAL,CAAiB,KAAKR,SAAL,CAAe4B,MAAhC,EAAwCb,YAAxC,CAAqD9B,GAAGkD,KAAxD,EAA+DC,MAA/D,GAAwEH,GAAxE;AACA,aAAKzB,WAAL,CAAiB,KAAKR,SAAL,CAAe4B,MAAhC,EAAwClB,MAAxC,GAAiD,IAAjD;AACA,aAAKV,SAAL,CAAeqC,IAAf,CAAoBJ,GAApB;AACA,YAAI,KAAKjC,SAAL,CAAe4B,MAAf,GAAwB,KAAKtB,MAAjC,EAAyC;AACrC;AACH;AACD,YAAMgC,MAAM,KAAKR,gBAAL,CAAsB,KAAK9B,SAA3B,CAAZ;AACA,YAAI,KAAKP,SAAL,KAAmBT,UAAUI,YAAjC,EAA+C;AAC3CmD,gBAAIC,KAAJ,CAAUC,QAAV,CAAmB,WAAnB,EAAgC,EAACC,MAAM,IAAP,EAAaC,MAAM,cAAnB,EAAhC;AACAJ,gBAAIK,GAAJ,CAAQC,KAAR,CAAc,oBAAd,EAAoC,EAACC,MAAMR,GAAP,EAApC,EAAiD,UAASS,IAAT,EAAe;AAC5D,oBAAIA,KAAKC,OAAL,IAAgBD,KAAKC,OAAL,KAAiB,CAArC,EAAwC;AACpCT,wBAAIC,KAAJ,CAAUC,QAAV,CAAmB,WAAnB,EAAgC,EAACC,MAAM,KAAP,EAAhC;AACA;AACH;AACDH,oBAAIU,EAAJ,CAAOC,OAAP,CAAe,YAAf,EAA6BH,IAA7B;AACH,aAND;AAOH,SATD,MASO,IAAI,KAAKtD,SAAL,KAAmBT,UAAUG,SAAjC,EAA4C;AAC/CoD,gBAAIU,EAAJ,CAAOC,OAAP,CAAe,aAAf,EAA8BZ,GAA9B;AACH;AACJ;AAtGI,CAAT","file":"hallEnterNum.js","sourceRoot":"../../../../../../assets/hall/script/hall","sourcesContent":["let GameCfg = require('GameCfg');\nlet Audio = require('Audio');\nconst PanelType = cc.Enum({\n    enterRoom: 0,\n    viewPlayback: 1,\n});\n\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        panelType: {\n            type: PanelType,\n            default: PanelType.enterRoom,\n        },\n    },\n\n    onLoad () {\n        let bg = this.node.getChildByName('back');\n        this.targetNum = [];\n        bg.getChildByName('btnClose').on('click', this.onBtnCloseClick, this);\n        bg.getChildByName('btnClean').on('click', this.onBtnCleanClick, this);\n        bg.getChildByName('btnReenter').on('click', this.onBtnReenterClick, this);\n        let enterNumber = bg.getChildByName('enterNumber');\n        this.maxNum = enterNumber.childrenCount;\n        this.numberEnter = [];\n        for (let i = 0; i < this.maxNum; i++) {\n            this.numberEnter[i] = enterNumber.getChildByName(\"num_\" + (i+1)).getChildByName('content');\n            this.numberEnter[i].active = false;\n        }\n        let numBtns = bg.getChildByName('numBtns');\n        for (let i = 0; i < 10; i++) {\n            numBtns.getChildByName(\"btnNum\" + i).on('click', this.onNumBtnClick.bind(this, i));\n        }\n\n        this.animation = this.node.getComponent(cc.Animation);\n        this.clips = this.animation.getClips();\n    },\n\n    onEnable () {\n        this.animation.play(this.clips[0].name);\n    },\n\n    onBtnCloseClick() {\n        Audio.playEffect('hall', 'button_close.mp3');\n        this.animation.play(this.clips[1].name).once('finished', this.onAnimationFinished, this);\n    },\n\n    onAnimationFinished () {\n        if (this.panelType === PanelType.viewPlayback) {\n            this.node.destroy();\n        } else {\n            this.targetNum = [];\n            this.numberEnter.forEach(function (v) {\n                v.active = false;\n            });\n            this.node.active = false;\n        }\n    },\n\n    onBtnCleanClick() {\n        Audio.playEffect('hall', 'button_close.mp3');\n        if (this.targetNum.length <= 0) {\n            return;\n        }\n        this.targetNum.pop();\n        this.numberEnter[this.targetNum.length].active = false;\n    },\n\n    onBtnReenterClick() {\n        Audio.playEffect('hall', 'button_close.mp3');\n        this.targetNum = [];\n        this.numberEnter.forEach(function (v) {\n            v.active = false;\n        });\n    },\n\n    getRoomIdByArray(arr) {\n        let roomid = '';\n        arr.forEach(function(num){\n            roomid += num;\n        });\n        return parseInt(roomid);\n    },\n\n    onNumBtnClick(num) {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        if (this.targetNum.length >= this.maxNum) {\n            return;\n        }\n        this.numberEnter[this.targetNum.length].getComponent(cc.Label).string = num;\n        this.numberEnter[this.targetNum.length].active = true;\n        this.targetNum.push(num);\n        if (this.targetNum.length < this.maxNum) {\n            return;\n        }\n        const rId = this.getRoomIdByArray(this.targetNum);\n        if (this.panelType === PanelType.viewPlayback) {\n            fun.event.dispatch('Zhuanquan', {flag: true, text: '回放加载中，请稍后...'});\n            fun.net.pSend('ReplayRecordByCode', {Code: rId}, function(data) {\n                if (data.RetCode && data.RetCode !== 0) {\n                    fun.event.dispatch('Zhuanquan', {flag: false});\n                    return;\n                }\n                fun.db.setData('ReplayInfo', data);\n            });\n        } else if (this.panelType === PanelType.enterRoom) {\n            fun.db.setData('EnterRoomId', rId);\n        }\n    },\n});\n"]}
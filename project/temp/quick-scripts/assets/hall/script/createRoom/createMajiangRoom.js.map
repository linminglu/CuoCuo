{"version":3,"sources":["createMajiangRoom.js"],"names":["Audio","require","majiangType","cc","Enum","maJiangWenLing","maJiangHuangYan","wenlingMj","init","node","context","updataParentN","gameConst","gameType","initQuanAndJu","ZhiFuN","createN","getChildByName","initExplainItem","CREATROOMWL","explain","initSwitchItem","initSingleItem","GameDefine","defineData","JuShu","data","quanList","juList","jushuN","descL","getComponent","Label","self","boxN","quanN","juN","on","setRoomInfo","itemList","n","l","desc","update","curJuShu","getRoomInfo","forEach","item","active","lItem","nIndex","curCountList","curCountIndex","string","disL","typeL","slice","defaultV","oldCreate","btnIncrease","btnReduce","onCountChange","changeNum","newIndex","length","onInfoChange","roomInfo","per","ZhiFu","cost","needCardL","onCreateClicked","GameType","Address","fun","db","getData","location","utils","saveCreateRoomData","event","dispatch","flag","text","net","pSend","rsp","RetCode","EnterRoom","setData","director","preloadScene","loadScene","mjGameDefine","str","WLRETCODE","contentStr","okBtnStr","okCb","onRechargeClicked","bind","huangyanMj","CREATROOMHY","undefined","index","GameNum","defMethod","SpendMethod","sendData","PlayerID","UserId","RoomInformation","RoomId","RoomID","HYRETCODE","PaymentMethod","gameCount","prototype","new","Class","extends","Component","properties","gameName","type","default","store","Prefab","roomCard","onLoad","downNode","onBtnCloseClick","initMjList","updateMj","animation","Animation","clips","getClips","add","addCard","_currentRoomCards","parseInt","_wxPaySuccess","onDestroy","remove","onEnable","play","name","mjSysList","curMj","dt","showStore","gameCfg","releaseType","release","instantiate","parent","setGameType","showRoomCard","num","playEffect","once","destroy"],"mappings":"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","file":"createMajiangRoom.js","sourceRoot":"../../../../../../assets/hall/script/createRoom","sourcesContent":["//******************************************** Majiang Sys  ********************\nlet Audio = require('Audio');\nvar majiangType = cc.Enum({\n    maJiangWenLing: 1,\n    maJiangHuangYan: 2,\n});\n\nvar wenlingMj = function () {\n    this.init = function(node, context){\n        this.context = context;\n        this.updataParentN(node, gameConst.gameType.maJiangWenLing); \n        this.initQuanAndJu();\n       \n        let ZhiFuN = this.createN.getChildByName(\"fangfeiBox\").getChildByName(\"shuoming\");\n        this.initExplainItem(ZhiFuN, \"ZhiFu\", require(\"mjGameDefine\").CREATROOMWL.explain)\n         this.initSwitchItem(\"fangfeiBox\", [1, 2, 3], 0, \"ZhiFu\");;\n        this.initSwitchItem(\"shengpaiBox\", [1], 0, \"ShengPaiTime\");\n        // this.initSwitchItem(\"renshuBox\", [1, 2, 3], 0, \"RenShu\"); \n        this.initSwitchItem(\"renshuBox\", [1], 0, \"RenShu\"); \n        this.initSwitchItem(\"moshiBox\", [1, 2, 3], 0, \"MoShi\");\n        this.initSwitchItem(\"wanfaBox\", [1, 2, 3], 0, \"WanFa\");\n        this.initSingleItem(\"teshuBox\", false, \"DingWei\");\n        this.initSingleItem(\"baopaiBox\", true, \"BaoPai\");\n        // this.initItemHideList(\"renshuBox\", 2, \"RenShu3\", [{name:\"moshiBox\", index:3}]);\n        // this.initItemHideList(\"moshiBox\", 2, \"MoShi3\", [{name:\"renshuBox\", index:3}]);\n    }\n    this.initQuanAndJu = function(){\n        var GameDefine = require(\"mjGameDefine\");\n        var defineData = GameDefine.CREATROOMWL.JuShu.data;\n        var quanList = [11, 12, 14];\n        var juList   = [21, 22, 24];\n        var jushuN   = this.createN.getChildByName(\"jushuBox\");\n        var descL    = jushuN.getChildByName(\"desc\").getComponent(cc.Label);\n        var self     = this;\n        var boxN     = jushuN.getChildByName(\"box\");\n        var quanN   = jushuN.getChildByName(\"quan\").getChildByName(\"checkmark\");\n        var juN     = jushuN.getChildByName(\"ju\").getChildByName(\"checkmark\");\n\n        jushuN.getChildByName(\"quan\").on(\"touchend\", function(){\n            self.setRoomInfo(\"JuShu\", quanList[0]);\n        })\n        jushuN.getChildByName(\"ju\").on(\"touchend\", function(){\n            self.setRoomInfo(\"JuShu\", juList[0]);\n        })\n\n        jushuN.itemList = [\n            {n: quanN, l : quanList, desc : \"选择游戏总圈数\"}, \n            {n : juN, l : juList, desc : \"选择游戏总局数\"}\n        ]\n        jushuN.update = function(){\n            var curJuShu = self.getRoomInfo()[\"JuShu\"];\n            jushuN.itemList.forEach(function(item){\n                item.n.active = false;\n                item.l.forEach(function(lItem, nIndex){\n                    if(lItem == curJuShu){\n                        item.n.active = true\n                        self.curCountList = item.l;\n                        self.curCountIndex = nIndex;\n                    }\n                })\n                if(item.n.active){\n                    descL.string = item.desc;\n                }\n            })\n            var disL     = boxN.getChildByName(\"num\").getComponent(cc.Label);\n            var typeL    = boxN.getChildByName(\"content\").getComponent(cc.Label);\n            disL.string  = defineData[curJuShu].slice(0, -1);\n            typeL.string = defineData[curJuShu].slice(-1);\n\n        };\n        this.jushuN       = jushuN;\n        var defaultV      = this.oldCreate.JuShu || quanList[0];\n        this.setRoomInfo(\"JuShu\", defaultV);\n        var btnIncrease   = boxN.getChildByName(\"increase\");\n        var btnReduce     = boxN.getChildByName(\"reduce\");\n        var onCountChange = function(changeNum){\n            var newIndex  = self.curCountIndex + changeNum;\n            if(newIndex < 0 || newIndex > (self.curCountList.length -1)){return} \n            self.setRoomInfo(\"JuShu\", self.curCountList[newIndex]);\n        }\n        btnIncrease.on(\"touchend\", function(){\n            onCountChange(1);\n        })\n        btnReduce.on(\"touchend\", function(){\n            onCountChange(-1);\n        })\n        \n\n    }\n\n    this.onInfoChange = function(){\n        this.jushuN.update()\n        var roomInfo = this.getRoomInfo();\n        var per = (roomInfo.ZhiFu == 2) ? 4 : 16;\n        var cost = 0 \n        if(roomInfo.JuShu > 20){\n            cost = (roomInfo.JuShu - 20) * per\n        }else {\n            cost = (roomInfo.JuShu - 10) * per\n        }\n        this.context.needCardL.string = cost;\n    }\n\n    this.onCreateClicked = function(){\n        var roomInfo      = this.getRoomInfo();\n        roomInfo.GameType = this.gameType; //游戏种类 - wenling majiang  \n        roomInfo.Address  = fun.db.getData('UserInfo').location;\n        fun.utils.saveCreateRoomData(roomInfo);\n        fun.event.dispatch('Zhuanquan', {flag:true, text:\"创建房间中，请稍后...\"});\n        fun.net.pSend('CreateRoom', roomInfo, function(rsp){\n            if (!rsp.RetCode) {\n                rsp.EnterRoom = 'create';\n                fun.db.setData('RoomInfo', rsp);\n                cc.director.preloadScene(\"majiang\", function(){\n                   cc.director.loadScene('majiang');\n                })\n            } else {\n                var mjGameDefine = require(\"mjGameDefine\");\n                fun.event.dispatch('Zhuanquan', false);\n                 var str = (mjGameDefine.WLRETCODE[rsp.RetCode]) || \"失败 :\"+rsp.RetCode;\n                if(rsp.RetCode == 19){\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: str, okBtnStr:\"前往充值\", okCb: this.onRechargeClicked.bind(this)});\n                }else{\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: str});\n                }\n            }\n        }.bind(this));\n    }\n}\nvar huangyanMj = function () {\n    this.init = function(node, context){\n        this.context = context;\n        this.updataParentN(node, gameConst.gameType.maJiangHuangYan); \n        this.initQuanAndJu();\n        let ZhiFuN = this.createN.getChildByName(\"shouxufeiBox\").getChildByName(\"shuoming\");\n        this.initExplainItem(ZhiFuN, \"PaymentMethod\", require(\"mjGameDefine\").CREATROOMHY.explain);\n        // this.initSwitchItem(\"tishiBox\", [1, 2], 1, \"NoticeType\");\n        // this.initSwitchItem(\"jushuBox\", [1, 2, 4], 0, \"GameNum\");\n        this.initSwitchItem(\"shouxufeiBox\", [1, 2, 3], 0, \"PaymentMethod\");\n        this.initSwitchItem(\"wanfaBox\", [1, 2], 0, \"GshOp\")\n        this.initSingleItem(\"teshuBox\", false, \"DingWei\");\n        // this.setRoomInfo(\"isAllowWatch\", 2);\n        // this.setRoomInfo(\"NoticeType\", 2);\n        \n        \n    }\n\n\n    this.initQuanAndJu = function(){\n        var GameDefine = require(\"mjGameDefine\");\n        var defineData = GameDefine.CREATROOMHY;\n        var quanList = [1, 2, 4];\n        var juList   = [4, 8, 16];\n        var jushuN   = this.createN.getChildByName(\"jushuBox\");\n        var self     = this;\n        var boxN     = jushuN.getChildByName(\"box\");\n        var quanN   = jushuN.getChildByName(\"quan\").getChildByName(\"checkmark\");\n        var juN     = jushuN.getChildByName(\"ju\").getChildByName(\"checkmark\");\n        var descL    = jushuN.getChildByName(\"desc\").getComponent(cc.Label);\n        jushuN.getChildByName(\"quan\").on(\"touchend\", function(){\n            self.setRoomInfo(\"SpendMethod\", 1);\n            self.setRoomInfo(\"GameNum\", quanList[0]);\n        })\n        jushuN.getChildByName(\"ju\").on(\"touchend\", function(){\n            self.setRoomInfo(\"SpendMethod\", 2);\n            self.setRoomInfo(\"GameNum\", juList[0]);\n        })\n\n        jushuN.itemList = [\n            {n: quanN, l : quanList}, \n            {n : juN, l : juList}\n        ]\n        //SpendMethod 1表示按圈收费 2表示按局收费\n        jushuN.update = function() {\n            var curJuShu = self.getRoomInfo()[\"GameNum\"];\n            quanN.active = self.getRoomInfo()[\"SpendMethod\"] == 1;\n            juN.active   = self.getRoomInfo()[\"SpendMethod\"] == 2;\n            var disL     = boxN.getChildByName(\"num\").getComponent(cc.Label);\n            var typeL    = boxN.getChildByName(\"content\").getComponent(cc.Label);\n            disL.string  = curJuShu === undefined ? 1 : curJuShu;\n            typeL.string = self.getRoomInfo()[\"SpendMethod\"] == 1 ? \"圈\":\"局\";\n            self.curCountList = self.getRoomInfo()[\"SpendMethod\"] == 1 ? quanList: juList;\n            self.curCountList.forEach(function(item, index){\n                if(curJuShu == item){\n                    self.curCountIndex = index;\n                }\n            })\n            descL.string = quanN.active ? \"选择游戏总圈数\" : \"选择游戏总局数\";\n        };\n        this.jushuN       = jushuN;\n        var defaultV  = this.oldCreate.GameNum || quanList[0];\n        var defMethod = this.oldCreate.SpendMethod || 1;\n        this.setRoomInfo(\"SpendMethod\", defMethod);\n        this.setRoomInfo(\"GameNum\", defaultV);\n        var btnIncrease   = boxN.getChildByName(\"increase\");\n        var btnReduce     = boxN.getChildByName(\"reduce\");\n        var onCountChange = function(changeNum){\n            var newIndex  = self.curCountIndex + changeNum;\n            if(newIndex < 0 || newIndex > (self.curCountList.length -1)){return} \n            self.setRoomInfo(\"GameNum\", self.curCountList[newIndex]);\n        }\n        btnIncrease.on(\"touchend\", function(){\n            onCountChange(1);\n        })\n        btnReduce.on(\"touchend\", function(){\n            onCountChange(-1);\n        })\n        \n\n    }\n\n\n    this.onCreateClicked = function(){\n        var roomInfo = this.getRoomInfo();\n        var sendData = {\n            PlayerID : fun.db.getData(\"UserInfo\").UserId,//玩家帐号\n            RoomInformation   : roomInfo,//房间信息\n            GameType : this.gameType,\n            Address  : fun.db.getData('UserInfo').location,\n        }\n        fun.event.dispatch('Zhuanquan', {flag:true, text:\"创建房间中，请稍后...\"});\n        fun.net.pSend('CreateRoom', sendData, function(rsp){\n            if(!rsp.RetCode){\n                sendData.RoomId = rsp.RoomID\n                fun.db.setData('hymajiang', rsp);\n                fun.db.setData('RoomInfo', sendData);\n                cc.director.preloadScene(\"majiang\", function(){\n                    cc.director.loadScene('majiang');\n                })\n                roomInfo.GameType = this.gameType; //游戏种类 - wenling majiang  \n                fun.utils.saveCreateRoomData(roomInfo);\n            }else {\n                fun.event.dispatch('Zhuanquan', false);\n                var mjGameDefine = require(\"mjGameDefine\");\n                var str = (mjGameDefine.HYRETCODE[rsp.RetCode]) || \"失败 :\"+rsp.RetCode;\n                if(rsp.RetCode == 19){\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: str, okBtnStr:\"前往充值\", okCb: this.onRechargeClicked.bind(this)});\n                }else{\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: str});\n                }\n            }\n          \n        }.bind(this));\n    }\n\n    this.onInfoChange = function(){\n        this.jushuN.update()\n        var roomInfo = this.getRoomInfo();\n        var per      = (roomInfo.PaymentMethod == 2) ? 4 : 16;\n        var gameCount= roomInfo.GameNum\n        if(roomInfo.SpendMethod == 2){\n            gameCount = gameCount / 4;\n        }\n        this.context.needCardL.string = gameCount * per;\n    }\n    \n}\nwenlingMj.prototype  = require(\"createRoomSys\").new();\nhuangyanMj.prototype = require(\"createRoomSys\").new();\n\n//******************************************** UI  ********************\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n    \tgameName: {\n            type: majiangType,\n            default: majiangType.maJiangWenLing,\n        },\n        store: cc.Prefab,\n        roomCard: cc.Label,\n        needCardL : cc.Label,\n    },\n\n    onLoad () {\n        let downNode = this.node.getChildByName('back').getChildByName('down');\n        downNode.getChildByName('btnClose').on('click', this.onBtnCloseClick, this);\n        this.initMjList();\n        this.updateMj();\n        this.animation = this.node.getComponent(cc.Animation);\n        this.clips = this.animation.getClips();\n        fun.event.add('CreateHYAddRoomCard', 'HuangYanAddRoomCard', function(addCard){\n            this._currentRoomCards = parseInt(this.roomCard.string) + parseInt(addCard);\n            this._wxPaySuccess = true;\n        }.bind(this));\n\n    },\n\n    onDestroy: function () {\n        fun.event.remove('CreateHYAddRoomCard');\n    },\n\n    onEnable () {\n        this.animation.play(this.clips[0].name);\n    },\n\n    initMjList (){\n        this.mjSysList = {};\n        this.mjSysList[majiangType.maJiangWenLing] = new wenlingMj();\n        this.mjSysList[majiangType.maJiangHuangYan] = new huangyanMj();\n    },\n\n    updateMj(){\n        this.curMj = this.mjSysList[this.gameName];\n        this.curMj.init(this.node, this);\n    },\n\n    update(dt){\n        if(this._wxPaySuccess){\n            this.roomCard.string = this._currentRoomCards;\n            this._wxPaySuccess = false;\n        }\n    },\n\n    showStore(gameType){\n        if (fun.gameCfg.releaseType === gameConst.releaseType.release) {\n            fun.event.dispatch('MinSingleButtonPop', {contentStr: '公测期间，免费畅玩！'});\n        } else {\n            let store = cc.instantiate(this.store);\n            store.parent = this.node;\n            store.getComponent('store').setGameType(gameType);\n        }\n    },\n\n    showRoomCard(num){\n        this.roomCard.string = num;\n    },\n\n    onBtnCloseClick () {\n        Audio.playEffect('hall', 'button_close.mp3');\n        this.animation.play(this.clips[1].name).once('finished', function(){\n            this.node.destroy();\n        }, this);\n    },\n});\n"]}
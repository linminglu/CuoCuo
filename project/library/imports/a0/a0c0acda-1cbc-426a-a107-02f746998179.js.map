{"version":3,"sources":["../../../../../../assets/hall/script/public/assets/hall/script/public/set.js"],"names":["Audio","require","cc","Class","extends","Component","properties","dialectToggle","Node","onLoad","bg","node","getChildByName","soundToggle","getComponent","Toggle","soundProgress","ProgressBar","soundSlider","fun","gameCfg","soundValume","isChecked","progressBar","JSON","parse","sys","localStorage","getItem","s","_soundProgress","sound","progress","Slider","on","onSoundSliderSlide","musicToggle","musicProgress","musicSlider","musicValume","m","_musicProgress","music","onMusicSliderSlide","languageBox","mandarinToggle","localismToggle","parseInt","voiceLanguage","gameConst","mandarin","onBtnCloseClick","writeOffBtn","onWriteOffBtnClick","animation","Animation","clips","getClips","onEnable","play","name","event","detail","setEffectVolume","setMusicVolume","onSoundToggleClicked","_soundVolum","onMusicToggleClicked","_musicVolum","setGameType","gameType","interactable","active","playEffect","removeItem","utils","restart","valumeData","stringify","setItem","huangYan","once","destroy","hideWriteOffBtn"],"mappings":"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","file":"set.js","sourceRoot":"../../../../../../assets/hall/script/public","sourcesContent":["let Audio = require('Audio');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        dialectToggle: cc.Node,\n    },\n\n    onLoad() {\n        let bg = this.node.getChildByName('back');\n        this.soundToggle = bg.getChildByName('soundToggle').getComponent(cc.Toggle);\n        this.soundProgress = bg.getChildByName('soundProgress').getComponent(cc.ProgressBar);\n        this.soundSlider = bg.getChildByName('soundSlider');\n        if (fun.gameCfg.soundValume === 0) {\n            this.soundToggle.isChecked = false;\n        } else {\n            this.soundToggle.isChecked = true;\n        }\n        let progressBar = JSON.parse(cc.sys.localStorage.getItem('progressBar'));\n        let s = fun.gameCfg.soundValume;\n        this._soundProgress = progressBar ? (progressBar.sound ? progressBar.sound : s) : s\n        this.soundProgress.progress = this._soundProgress;\n        this.soundSlider.getComponent(cc.Slider).progress = this._soundProgress;\n        this.soundSlider.on('slide', this.onSoundSliderSlide, this);\n\n        this.musicToggle = bg.getChildByName('musicToggle').getComponent(cc.Toggle);\n        this.musicProgress = bg.getChildByName('musicProgress').getComponent(cc.ProgressBar);\n        this.musicSlider = bg.getChildByName('musicSlider');\n        if (fun.gameCfg.musicValume === 0) {\n            this.musicToggle.isChecked = false;\n        } else {\n            this.musicToggle.isChecked = true;\n        }\n        let m = fun.gameCfg.musicValume;\n        this._musicProgress = progressBar ? (progressBar.music ? progressBar.music : m) : m;\n        this.musicProgress.progress = this._musicProgress;\n        this.musicSlider.getComponent(cc.Slider).progress = this._musicProgress;\n        this.musicSlider.on('slide', this.onMusicSliderSlide, this);\n\n        const languageBox = bg.getChildByName('languageBox');\n        this.mandarinToggle = languageBox.getChildByName('toggle1').getComponent(cc.Toggle);\n        this.localismToggle = languageBox.getChildByName('toggle2').getComponent(cc.Toggle);\n        if (parseInt(fun.gameCfg.voiceLanguage) === gameConst.voiceLanguage.mandarin) {\n            this.mandarinToggle.isChecked = true;\n            this.localismToggle.isChecked = false;\n        } else {\n            this.mandarinToggle.isChecked = false;\n            this.localismToggle.isChecked = true;\n        }\n        bg.getChildByName('btnClose').on('click', this.onBtnCloseClick, this);\n        this.writeOffBtn = bg.getChildByName('writeOffBtn');\n        this.writeOffBtn.on('click', this.onWriteOffBtnClick, this);\n\n        this.animation = this.node.getComponent(cc.Animation);\n        this.clips = this.animation.getClips();\n    },\n\n    onEnable () {\n        this.animation.play(this.clips[0].name);\n    },\n\n    onSoundSliderSlide (event) {\n        this.soundProgress.progress = event.detail.progress;\n        fun.gameCfg.soundValume = event.detail.progress;\n        this._soundProgress = fun.gameCfg.soundValume;\n        Audio.setEffectVolume(this._soundProgress);\n        if (this._soundProgress === 0)\n            this.soundToggle.isChecked = false;\n        else\n            this.soundToggle.isChecked = true;\n    },\n\n    onMusicSliderSlide (event) {\n        this.musicProgress.progress = event.detail.progress;\n        fun.gameCfg.musicValume = event.detail.progress;\n        this._musicProgress = fun.gameCfg.musicValume;\n        Audio.setMusicVolume(this._musicProgress);\n        if (this._musicProgress === 0)\n            this.musicToggle.isChecked = false;\n        else\n            this.musicToggle.isChecked = true;\n    },\n\n    onSoundToggleClicked () {\n        this._soundVolum = this.soundToggle.isChecked ? this._soundProgress : 0;\n        fun.gameCfg.soundValume = this._soundVolum;\n        Audio.setEffectVolume(this._soundVolum);\n    },\n\n    onMusicToggleClicked () {\n        this._musicVolum = this.musicToggle.isChecked ? this._musicProgress : 0;\n        fun.gameCfg.musicValume = this._musicVolum;\n        Audio.setMusicVolume(this._musicVolum);\n    },\n\n    setGameType (gameType) {\n        if (gameType === 'pork') {\n            this.dialectToggle.getComponent(cc.Toggle).interactable = false;\n            this.dialectToggle.getChildByName('back').active = true;\n        } else {\n            this.dialectToggle.interactable = true;\n            this.dialectToggle.getChildByName('back').active = false;\n        }\n    },\n\n    onWriteOffBtnClick() {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        cc.sys.localStorage.removeItem('Token');\n        fun.utils.restart();\n    },\n\n    onBtnCloseClick() {\n        Audio.playEffect('hall', 'button_close.mp3');\n        let s = this._soundVolum, m = this._musicVolum;\n        fun.gameCfg.musicValume = (m && m > 0) ? m : (m === 0 ? 0 : fun.gameCfg.musicValume);\n        fun.gameCfg.soundValume = (s && s > 0) ? s : (s === 0 ? 0 : fun.gameCfg.soundValume);\n        let valumeData = JSON.stringify({sound: fun.gameCfg.soundValume, music: fun.gameCfg.musicValume});\n        cc.sys.localStorage.setItem('valumeData', valumeData);\n        fun.gameCfg.voiceLanguage = this.mandarinToggle.isChecked ? gameConst.voiceLanguage.mandarin : gameConst.voiceLanguage.huangYan;\n        cc.sys.localStorage.setItem('voiceLanguage', fun.gameCfg.voiceLanguage);\n        let progressBar = JSON.stringify({sound: this._soundProgress, music: this._musicProgress});\n        cc.sys.localStorage.setItem('progressBar', progressBar);\n        this.animation.play(this.clips[1].name).once('finished', function () {\n            this.node.destroy();\n        }, this);\n    },\n\n    hideWriteOffBtn() {\n        this.writeOffBtn.active = false\n    },\n\n});\n"]}
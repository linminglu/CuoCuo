{"version":3,"sources":["../../../../../../../assets/mahjong/script/game/paiju/assets/mahjong/script/game/paiju/mjPaijuShang.js"],"names":["mjDataMgr","require","shangControl","init","paiScale","get","KEYS","CFG","pengGangHeng","pengGangZhi","gangDiff","EndWidth","EndHeight","shouWidth","paiListNode","defX","x","dachuPaiN","is3DView","cc","sys","localStorage","getItem","fun","event","add","onViewChange","bind","refrePaiNode","initRound","superInitRound","shouPaiN","pengStartPos","pengGangPaiN","_OnDestroy","remove","isPlaying","refreDachuPai","scaleX","scaleY","buhuaPaiN","getPengGangInfo","pai","pengGangLen","index","info","zOrder","pos","p","paiZoneList","showType","len","setShouRelativePos","setShouPaiPos","paiNode","shouLen","isMo","width","setPosition","getShouPaiInfo","PaiType","PAISHOWTYPE","PENG","getDachuInfo","horizontal","honIndex","verIndex","Math","floor","startScale","zoomScale","mj3DLen","bgFrameName","curScale","sfScale","contentPos","pow","skewX","getBuhuaInfo","module","exports","instance"],"mappings":"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","file":"mjPaijuShang.js","sourceRoot":"../../../../../../../assets/mahjong/script/game/paiju","sourcesContent":["\nvar mjDataMgr     = require(\"mjDataMgr\");\n/////////////////////////////// 上方玩家 //////////////////////////////////////////////////////////\n\nvar shangControl = function(){\n    \n    this.init = function(){\n        this.paiScale     =mjDataMgr.get(mjDataMgr.KEYS.CFG).paiScale || 1;\n        this.pengGangHeng = 41* this.paiScale;\n        this.pengGangZhi  = 58* this.paiScale;   \n        this.gangDiff     = 10;\n        this.EndWidth     = 40;\n        this.EndHeight    = 50;\n        this.shouWidth    = 33* this.paiScale;\n        this.paiListNode.defX = this.paiListNode.defX || this.paiListNode.x;\n        this.dachuPaiN.defX = this.dachuPaiN.defX || this.dachuPaiN.x;\n        this.is3DView        = cc.sys.localStorage.getItem(\"mjEyeView\") == \"3D\";\n        fun.event.add(\"mjViewChangeShang\", \"mjViewChange\", this.onViewChange.bind(this));\n        this.refrePaiNode();\n    }\n\n    this.initRound = function(){\n        this.superInitRound();\n        this.shouPaiN.x     = this.pengStartPos.x;\n        this.pengGangPaiN.x = this.pengStartPos.x;\n    }\n\n    this._OnDestroy = function(){\n        fun.event.remove(\"mjViewChangeShang\");\n    }\n\n    this.onViewChange = function(){\n        this.is3DView = cc.sys.localStorage.getItem(\"mjEyeView\") ==\"3D\";\n        if(!require(\"mjGameManager\").isPlaying){return}\n        // this.removeNodeChild(this.dachuPaiN);\n        this.refreDachuPai();\n        // this.removeNodeChild(this.buhuaPaiN);\n        // this.refreBuhua();\n        this.refrePaiNode();\n    }\n\n    this.refrePaiNode = function(){\n        this.shouPaiN.scaleX     = this.is3DView ? 0.9 : 1\n        this.shouPaiN.scaleY     = this.is3DView ? 0.8 : 1\n        this.pengGangPaiN.scaleX = this.is3DView ? 0.9 : 1\n        this.pengGangPaiN.scaleY = this.is3DView ? 0.8 : 1\n        this.buhuaPaiN.scaleX    = this.is3DView ? 0.63 : 0.7\n        this.buhuaPaiN.scaleY    = this.is3DView ? 0.63 : 0.7\n        this.paiListNode.x       = this.is3DView ?  this.paiListNode.defX - 40 : this.paiListNode.defX\n        this.dachuPaiN.x         = this.is3DView ?  this.dachuPaiN.defX + 40 : this.dachuPaiN.defX\n    }\n\n    this.getPengGangInfo = function(pai, pengGangLen, index){        \n        var info      = {}\n        info.zOrder   = index;\n        // if(!this.is3DView){\n           \n            if(index == 3){\n                info.zOrder   = 100;\n                info.pos = cc.p(0 - pengGangLen + this.paiZoneList[pai.showType] + this.pengGangHeng, 10);\n                info.len = pengGangLen\n            }else {\n                info.pos = cc.p(0 - pengGangLen, 0);\n                info.len = pengGangLen + this.paiZoneList[pai.showType]\n            }\n        // }else{\n\n        // }\n        return info;\n    }\n\n\n\n\n\n    this.setShouRelativePos = function(pengGangLen){\n        this.shouPaiN.x     = this.pengGangPaiN.x - pengGangLen - 10;\n    }\n\n    this.setShouPaiPos =  function(paiNode, pai, shouLen, isMo){\n        var width = this.paiZoneList[pai.showType];\n        shouLen   = isMo  ?  shouLen + width / 2 : shouLen\n        paiNode.setPosition(cc.p(0 - shouLen, 0));\n        return (shouLen + width);\n    }\n\n\n    this.getShouPaiInfo =  function(pai, shouLen, isMo, index){\n        var info    = {}\n        info.zOrder = index;\n        shouLen      = isMo  ?  shouLen + this.shouWidth / 2 : shouLen\n        info.pos     = cc.p(0 - shouLen, 0);\n        info.shouLen = shouLen + this.shouWidth\n        var PaiType   = require(\"mjGameDefine\").PAISHOWTYPE; \n        // if(!this.is3DView){\n            shouLen      = isMo  ?  shouLen + this.shouWidth / 2 : shouLen\n            info.pos     = cc.p(0 - shouLen, 0);\n            if(pai.showType == PaiType.PENG){\n                // info.curScale = this.paiScale * 0.8;\n                info.shouLen = shouLen + this.shouWidth * 1.26\n            }else {\n                info.shouLen = shouLen + this.shouWidth\n            }\n\n        // }else {\n\n        // }\n        return info;\n    }\n\n\n    this.getDachuInfo = function(index){\n        var horizontal = 11;\n        var honIndex   = index % horizontal ;\n        var verIndex   = Math.floor(index / horizontal)\n        var info       = {}\n        var startScale = 0.7;\n        var zoomScale  = 0.972;\n        info.is3DView = this.is3DView;\n        var mj3DLen = [0, 46,92, 137,184,229, 275.5, 320, 365.5, 409.5, 454]\n        if(!this.is3DView){\n            info.pos         = cc.p(0- honIndex * this.EndWidth, verIndex * this.EndHeight)\n            info.bgFrameName =\"pz_tang\";\n            info.zOrder      = (100 - index);\n            info.curScale    = 0.84;\n            info.sfScale     = 1.1;\n            info.contentPos  = cc.p(-25, 10);\n        }else{\n            // -22.7,10 \n            info.bgFrameName = \"s_d_\" + (10 -honIndex);\n            let curScale = startScale * Math.pow(zoomScale, verIndex);\n            let len = -60 +  -4.8 * verIndex +mj3DLen[honIndex] * curScale * -1;\n            info.pos = cc.p(len, Math.pow(0.978, verIndex) * 53 * startScale * verIndex - 10);\n            info.curScale = curScale;\n            info.zOrder = verIndex * -20 + honIndex * ((honIndex > 5) ? -1 : 1);\n            info.skewX   = (honIndex - 5) * 1.5 * curScale;\n            info.sfScale = 0.9;\n            info.contentPos = cc.p(-22.7 - honIndex/8, 10);\n        }\n        return info;\n    }\n\n    this.getBuhuaInfo = function(paiNode, index){\n        var info = {};\n        info.zOrder = index;\n        // info.is3DView = this.is3DView;\n        var startScale = 0.7;\n        var zoomScale  = 0.972;\n        var mj3DLen = [0, 46,92, 137,184,229, 275.5, 320, 365.5, 409.5, 454]\n        // if(true){\n            info.pos = cc.p(index * -40, 0);\n            info.bgFrameName =\"pz_tang\";\n            info.curScale = 0.84;\n        // }else {\n        //     var horizontal   = 22;\n        //     var honIndex     = index % horizontal ;\n        //     honIndex =  honIndex > 10 ? 10 : honIndex;\n        //     var verIndex     = Math.floor(index / horizontal) + 3\n        //     // info.bgFrameName = \"s_d_\" + (10 -honIndex);\n        //     info.bgFrameName = \"s_d_5\"\n        //     let curScale     = startScale * Math.pow(zoomScale, verIndex);\n        //     // info.skewX       = (honIndex  - 5) * 2 * curScale;\n        //     info.sfScale     = 0.82;\n        //     let len =  -4.8 * verIndex +mj3DLen[honIndex] * curScale * -1.3 - 124;\n        //     info.pos = cc.p(len, Math.pow(0.978, verIndex) * 53 * startScale * verIndex - 100);\n        // }\n        return info;\n    }\n\n};\n\nmodule.exports = {\n    instance : shangControl,\n}\n\n\n\n"]}
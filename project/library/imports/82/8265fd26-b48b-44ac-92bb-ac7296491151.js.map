{"version":3,"sources":["../../../../../../assets/poker/script/pukeComm/assets/poker/script/pukeComm/SanGongManager.js"],"names":["SanGongManager","PukeData","require","funUtils","PukeUtils","PukeDefine","Audio","initGame","gameUICB","UserInfo","fun","db","getData","MineUserId","UserId","MineSeat","getSeatByNumber","data","MineIsMaster","getRoomMasterByRoomInfo","FirstEnterRoom","initRoomInfo","initSeatInfo","initQZhuangFunction","initListener","update","dt","StartChooseZhuang","qzDtTime","chaTime","QIANG_ZHUANG_WAIT_TIME","DingZhuangTime","setBtnQZhuangActive","showHint","seatNum","QiangZhuangSeat","length","qzPersonNum","ZeroZhuangSeat","TurnZhuangTime","QIANG_ZHUANG_TURN_TIME","tzDtSingle","tzDtMore","TurnZhuangCount","TurnZhuang","setZhuangFalse","seat","Zhuang","active","onDestroy","cleanListener","RoomId","setData","SeatArray","faPaiPukes","faPaiSeats","copyDisbandPrefab","undefined","copyTotalAccount","updateSeatNumber","player","minePlayer","EnterRoom","i","value","checkIsMineUserId","Array","RoomIdx","cha","Math","abs","getSeatNumberByRoomIdx","roomIdx","num","getSeatByUserId","id","parseInt","getPukeSpriteById","paiId","cleanSeatData","Readying","j","ShuZi","YaBox","Ying","Shu","pushGold","seatNumber","goldNum","getGoldsNode","min","max","divisor","PUSH_GOLD_NUMBER","copyGold","getFromGoldPool","getChildByName","addChild","startPos","POSITION","GOLD","START_POS","setScale","setPosition","cc","p","x","y","time","random","endPos","END_POS","randPx","randPy","distance","pGetDistance","intCen","floor","setLocalZOrder","moveto","moveTo","easing","easeSineInOut","stopAllActions","runAction","playEffect","callInGold","winSeats","self","overTime","min2","max2","zhuangSeatNumber","CurrentZhuang","zhuangStartPos","goldSeat","childrenCount","gold","children","sequence","callFunc","putInGoldPool","scheduleOnceFunc","isZhuangShu","winSeat","goldWinSeat","SeatNumber","goldStartPos","Slice","maxTime","k","m","faPaiAnimation","index","setState","setBtnCuoPaiActive","SEND_CARD_COMPLETE_TIME","SEND_CARD_SINGLE_TIME","copyPuke","getPukePool","get","getChildNode","px","py","put","count","seatPuke","puke","myCards","getComponent","Sprite","spriteFrame","cuoPaiAnimation","type","showType","isCuoPaiComplete","copyCuoPai","getCuoPaiPool","pukeCuo","from","GameType","CuoPaiNumber","cb","net","send","showTypeFunc","initPuke","DZhuang","IsFreeQiangZhuang","reconnectReadyFunc","Players","Ready","setBtnReadyActive","players","key","content","State","jumpTextAnim","console","log","state","color","setGameStatus","Status","RoundJuShu","Round","TotalJuShu","Total","DiFen","ROOM_INFO","DI_FEN","DFeng","ZhuangWei","ZHUANG_WEI","Charge","COST","IsMaster","ISMASTER","msg","setCreateSeat","CardsMap","OnLine","Mask","setEnterSeat","Cards","RecentYaZhu","Zhu","ZhuangSp","setAnimation","startGameReady","setBtnInviteActive","ListenCBList","pListenCBList","listen","cmd","isPingTai","pListen","push","onEnterRoomAck","bind","onOnLineAck","onOffLineAck","onReadyNextAck","onQZhuangAck","onZhuangAck","onYaZhuAck","onSomeOneYaZhuAck","onStartGameAck","onShowCardAck","onSingleAccountAck","onTotalAccountAck","onLeaveRoomAck","onDisbandRoomResultAck","onDisbandRoomVoteAck","rmListen","rmPListen","Player","RetCode","HINT_TEXT","WAIT_QIANG_ZHUANG","Op","WAIT_XIA_ZHU","zhuangFunc","zhuangSeat","setBtnXuYaActive","resetFunc","Zhus","setBtnXiaZhuActive","showXiaZhu","getIsXuYa","onBtnXiaZhuClicked","ZI_DONG_XU_YA_TIME","YaZhu","string","sortCardsMap","userid","idx","pukes","seats","pos","getPosition","fuhao","getContentSize","width","SEND_CARD_DELAY","Dian","Bei","Card","anim","effectName","ShuZiSp","NIUNIU_ROOM_INFO","PAI_JU_SCORE","sex","Sex","accountMap","AccountMap","userArr","loseSeatArr","slice","loseId","score","Score","Fen","YingLabel","ShuLabel","BeiDianMap","WAIT_READY","setJuShuText","JuShu","highestScore","newData","Accounts","name","_Name","head","HeadUrl","left","RoomCards","Left","lost","Lost","sort","a","b","sortAccounts","WAIT_TOTAL_ACCOUNT","TOTAL_ACCOUNT_SHOW_TIME","removeFromParent","setCountDownTime","initTotalAccount","pukeNumber","GAME_TYPE","PUKE_NUMBER","resetSeat","setMenuBgActive","Disbanded","director","loadScene","DISBAND_ROOM_DELAY_TIME","getDisband","VoteInfo","Name","headUrl","disbandRoomInit","YaZhuFunction","yanum","rsp","LeaveRoomFunction","getGameStatus","OP","Leave","ReadyFunction","QZhuangFunction","wxShare","jushu","difen","info","title","WxShareFriend","module","exports"],"mappings":"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","file":"SanGongManager.js","sourceRoot":"../../../../../../assets/poker/script/pukeComm","sourcesContent":["let SanGongManager = {};\r\nlet PukeData       = require('PukeData');\r\nlet funUtils       = require('funUtils');\r\nlet PukeUtils      = require('PukeUtils');\r\nlet PukeDefine     = require('PukeDefine');\r\nlet Audio = require('Audio');\r\n\r\nSanGongManager.initGame = function(gameUICB){\r\n    this.gameUICB = gameUICB;\r\n    \r\n    this.UserInfo = fun.db.getData('UserInfo', true);\r\n    this.MineUserId = this.UserInfo.UserId;\r\n    this.MineSeat = this.getSeatByNumber(1);\r\n    this.data = fun.db.getData('RoomInfo');\r\n    this.MineIsMaster = this.getRoomMasterByRoomInfo();\r\n    this.FirstEnterRoom = true;\r\n    this.initRoomInfo();\r\n    this.initSeatInfo();\r\n    this.initQZhuangFunction();\r\n    this.initListener();\r\n}\r\n\r\nSanGongManager.update = function (dt) {\r\n    if(this.StartChooseZhuang){\r\n        this.qzDtTime = (this.qzDtTime || 0) + dt;\r\n        let chaTime = PukeDefine.QIANG_ZHUANG_WAIT_TIME - this.DingZhuangTime;\r\n        if(this.qzDtTime >= chaTime){\r\n            this.gameUICB.setBtnQZhuangActive(false);\r\n            this.gameUICB.showHint(false);\r\n            this.seatNum = this.QiangZhuangSeat.length;\r\n            let qzPersonNum = this.seatNum === 0 ? this.ZeroZhuangSeat.length : this.seatNum;\r\n            this.TurnZhuangTime = PukeDefine.QIANG_ZHUANG_TURN_TIME/(5*qzPersonNum);\r\n            this.tzDtSingle = 0;\r\n            this.tzDtMore = 0;\r\n            this.TurnZhuangCount = 0;\r\n            this.TurnZhuang = true;\r\n            this.StartChooseZhuang = false;\r\n            this.qzDtTime = 0;\r\n        }\r\n    }\r\n    if(this.TurnZhuang){\r\n        if(this.seatNum === 0){\r\n            this.tzDtSingle += dt;\r\n            if(this.tzDtSingle >= this.TurnZhuangTime){\r\n                this.tzDtSingle -= this.TurnZhuangTime;\r\n                this.TurnZhuangCount = this.TurnZhuangCount === this.ZeroZhuangSeat.length ? 1 : (this.TurnZhuangCount + 1);\r\n                this.setZhuangFalse();\r\n                let seat = this.getSeatByNumber(this.ZeroZhuangSeat[this.TurnZhuangCount-1]);\r\n                seat.Zhuang.active = true;\r\n            }\r\n        } else if (this.seatNum >= 2) {\r\n            this.tzDtMore += dt;\r\n            if(this.tzDtMore >= this.TurnZhuangTime){\r\n                this.tzDtMore -= this.TurnZhuangTime;\r\n                this.TurnZhuangCount = this.TurnZhuangCount === this.seatNum ? 1 : (this.TurnZhuangCount + 1);\r\n                this.setZhuangFalse();\r\n                let seat = this.getSeatByNumber(this.QiangZhuangSeat[this.TurnZhuangCount - 1]);\r\n                seat.Zhuang.active = true;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nSanGongManager.onDestroy  = function(){\r\n    this.cleanListener();\r\n    this.UserInfo.RoomId = 0;\r\n    fun.db.setData('UserInfo', this.UserInfo);\r\n    this.SeatArray = [];\r\n    this.UserInfo = {};\r\n    this.data = {};\r\n    this.faPaiPukes = [];\r\n    this.faPaiSeats = [];\r\n    this.QiangZhuangSeat = [];\r\n    this.ZeroZhuangSeat = [];\r\n    this.copyDisbandPrefab = undefined;\r\n    this.copyTotalAccount = undefined;\r\n}\r\n\r\n//-----------------------------------------------------------\r\n//----- 座位号 调整\r\nSanGongManager.updateSeatNumber = function (player) {\r\n    let minePlayer = {};\r\n    if (this.data.EnterRoom === 'enter') {\r\n        for (let i in player) {\r\n            let value = player[i];\r\n            if (this.checkIsMineUserId(value.UserId)) {\r\n                minePlayer = value;\r\n            }\r\n        }\r\n    } else if (this.data.EnterRoom === 'create') {\r\n        minePlayer = this.data;\r\n    }\r\n    this.SeatArray = new Array();\r\n    for (let i=0; i<6; i++) {\r\n        if (i === 0) {\r\n            this.SeatArray[0] = minePlayer.RoomIdx;\r\n        } else {\r\n            this.SeatArray[i] = '';\r\n        }\r\n    }\r\n    if (this.data.EnterRoom === 'enter') {\r\n        for (let i in player) {\r\n            let value = player[i];\r\n            let cha = Math.abs(minePlayer.RoomIdx - value.RoomIdx);\r\n            if (minePlayer.RoomIdx > value.RoomIdx) {\r\n                this.SeatArray[6-cha] = value.RoomIdx;\r\n            } else if (minePlayer.RoomIdx < value.RoomIdx) {\r\n                this.SeatArray[cha] = value.RoomIdx;\r\n            }\r\n        }\r\n    }\r\n}\r\n//----- 根据 RoomIdx 返回座位号\r\nSanGongManager.getSeatNumberByRoomIdx = function (roomIdx) {\r\n    for (let i = 0; i < this.SeatArray.length; i++) {\r\n        if (this.SeatArray[i] === roomIdx) {\r\n            return i+1;\r\n        }\r\n    }\r\n    return roomIdx + 1;\r\n}\r\n//----- 根据 座位号 获取 Seat\r\nSanGongManager.getSeatByNumber = function (num) {\r\n    return this.gameUICB.getSeatByNumber(num);\r\n}\r\n//----- 根据 UserId 获取 Seat\r\nSanGongManager.getSeatByUserId = function (id) {\r\n    for (let i=1; i<=6; i++) {\r\n        let seat = this.getSeatByNumber(i);\r\n        if (parseInt(seat.UserId) === parseInt(id)) {\r\n            return seat;\r\n        }\r\n    }\r\n}\r\n//----- 根据 牌ID 取牌\r\nSanGongManager.getPukeSpriteById = function (id) {\r\n    let paiId = id === 'pai' ? id : (Math.abs(id) - 3);\r\n    return this.gameUICB.getPukeSpriteById(paiId);\r\n}\r\n//----- 清空 座位 信息\r\nSanGongManager.cleanSeatData = function () {\r\n    for(let i=1; i<=6; i++){\r\n        let seat = this.getSeatByNumber(i);\r\n        seat.Readying.active = false;\r\n        for(let j=1; j<=3; j++){\r\n            seat['Puke'+j].active = false;\r\n        }\r\n        seat.ShuZi.active = false;\r\n        seat.YaBox.active = false;\r\n        seat.Ying.active  = false;\r\n        seat.Shu.active   = false;\r\n    }\r\n}\r\n//----- 金币押注动画\r\nSanGongManager.pushGold = function (seatNumber, goldNum) {\r\n    this.gameUICB.getGoldsNode().active = true;\r\n    let min = 2, max = 8, divisor = 12;\r\n    for (let j=0; j<PukeDefine.PUSH_GOLD_NUMBER; j++) {\r\n        let copyGold = this.gameUICB.getFromGoldPool();\r\n        this.gameUICB.getGoldsNode().getChildByName('seat'+seatNumber).addChild(copyGold);\r\n        let startPos = PukeDefine.POSITION.GOLD[seatNumber].START_POS;\r\n        copyGold.setScale(0.6);\r\n        copyGold.setPosition(cc.p(startPos.x, startPos.y));\r\n        let time     = funUtils.random(min, max)/divisor;\r\n        let endPos   = PukeDefine.POSITION.GOLD[seatNumber].END_POS;\r\n        let randPx   = endPos.x + funUtils.random(-30, 30);\r\n        let randPy   = endPos.y + funUtils.random(-30, 30);\r\n        let distance = PukeUtils.pGetDistance(startPos, cc.p(randPx, randPy));\r\n        let intCen   = Math.floor(distance/time);\r\n        copyGold.setLocalZOrder(1000 - intCen);\r\n        let moveto   = cc.moveTo(time, cc.p(randPx, randPy));\r\n        moveto.easing(cc.easeSineInOut());\r\n        copyGold.stopAllActions();\r\n        copyGold.runAction(moveto);\r\n    }\r\n    Audio.playEffect('pork', 'gold.wav');\r\n}\r\n//----- 金币回收动画\r\nSanGongManager.callInGold = function (winSeats) {\r\n    this.gameUICB.getGoldsNode().active = true;\r\n    let self = this;\r\n    let overTime = 0;\r\n    let min = 2, max = 10, min2 = 5, max2 = 15, divisor = 15;\r\n    let zhuangSeatNumber = this.getSeatNumberByRoomIdx(this.CurrentZhuang);\r\n    let zhuangStartPos = PukeDefine.POSITION.GOLD[zhuangSeatNumber].START_POS;\r\n    for (let i=1; i<=6; i++) {\r\n        let seat = this.getSeatByNumber(i);\r\n        if (seat.RoomIdx != this.CurrentZhuang) {\r\n            let goldSeat = this.gameUICB.getGoldsNode().getChildByName('seat'+i);\r\n            if (goldSeat.childrenCount > 0) {\r\n                for (let i=0; i<goldSeat.children.length; ++i) {\r\n                    let gold = goldSeat.children[i];\r\n                    let time = funUtils.random(min, max)/divisor;\r\n                    overTime = Math.max(time, overTime);\r\n                    let moveto = cc.moveTo(time, cc.p(zhuangStartPos.x, zhuangStartPos.y));\r\n                    moveto.easing(cc.easeSineInOut());\r\n                    gold.runAction(cc.sequence(moveto, cc.callFunc(function(){\r\n                        self.gameUICB.putInGoldPool(gold);\r\n                    })));\r\n                }\r\n            }\r\n        }\r\n    }\r\n    Audio.playEffect('pork', 'gold.wav');\r\n    this.gameUICB.scheduleOnceFunc(function(){\r\n        let isZhuangShu = false;\r\n        for (let i in winSeats) {\r\n            let winSeat = winSeats[i];\r\n            if (winSeat.RoomIdx != self.CurrentZhuang) {\r\n                let goldWinSeat = self.gameUICB.getGoldsNode().getChildByName('seat'+winSeat.SeatNumber);\r\n                let goldStartPos = PukeDefine.POSITION.GOLD[winSeat.SeatNumber].START_POS;\r\n                for (let j in winSeat.Slice) {\r\n                    let value = winSeat.Slice[j];\r\n                    let maxTime = 0;\r\n                    isZhuangShu = true;\r\n                    for (let k = 0; k < PukeDefine.PUSH_GOLD_NUMBER; ++k) {\r\n                        let gold = self.gameUICB.getFromGoldPool();\r\n                        goldWinSeat.addChild(gold);\r\n                        gold.setPosition(cc.p(zhuangStartPos.x, zhuangStartPos.y));\r\n                        let time = funUtils.random(min2, max2)/divisor;\r\n                        maxTime = Math.max(time, maxTime);\r\n                        let moveto = cc.moveTo(time, cc.p(goldStartPos.x, goldStartPos.y));\r\n                        moveto.easing(cc.easeSineInOut());\r\n                        gold.stopAllActions();\r\n                        gold.runAction(cc.sequence(moveto, cc.callFunc(function(){\r\n                            for (let m = 0; m < goldWinSeat.children.length; ++m) {\r\n                                let gold = goldWinSeat.children[m];\r\n                                self.gameUICB.putInGoldPool(gold);\r\n                            }\r\n                        })));\r\n                    }\r\n                    self.gameUICB.scheduleOnceFunc(function(){\r\n                        self.gameUICB.getGoldsNode().active = false;\r\n                        for (let num in goldWinSeat.children) {\r\n                            self.gameUICB.putInGoldPool(goldWinSeat.children[num]);\r\n                        }\r\n                    }, maxTime*0.98)\r\n                }\r\n            }\r\n        }\r\n        if (isZhuangShu) {\r\n            Audio.playEffect('pork', 'gold.wav');\r\n        }\r\n    }, overTime);\r\n}\r\n//----- 发牌动画\r\nSanGongManager.faPaiAnimation = function (index) {\r\n    Audio.playEffect('pork', 'fapai.mp3');\r\n    let self = this;\r\n    if (index >= this.faPaiPukes.length) {\r\n        this.gameUICB.scheduleOnceFunc(function(){\r\n            self.setState('搓牌中');\r\n            self.gameUICB.setBtnCuoPaiActive(true);\r\n        }, PukeDefine.SEND_CARD_COMPLETE_TIME)\r\n    } else {\r\n        let self = this;\r\n        let time = PukeDefine.SEND_CARD_SINGLE_TIME;\r\n        let copyPuke = this.gameUICB.getPukePool().get();\r\n        copyPuke.setPosition(0, 0);\r\n        this.gameUICB.getChildNode().getChildByName('puke').addChild(copyPuke);\r\n        let px = this.faPaiPukes[index].x, py = this.faPaiPukes[index].y;\r\n        let moveto = cc.moveTo(time, cc.p(px, py));\r\n        moveto.easing(cc.easeSineInOut());\r\n        copyPuke.runAction(cc.sequence(moveto, cc.callFunc(function(){\r\n            self.gameUICB.getPukePool().put(copyPuke);\r\n            let count = index%3 + 1;\r\n            let seat = self.faPaiSeats[Math.floor(index/3)]\r\n            let seatPuke = seat.getChildByName('puke'+count);\r\n            if (self.checkIsMineUserId(seat.UserId) && count != 3) {\r\n                let puke = self.faPaiSeats.myCards[count-1];\r\n                seatPuke.getComponent(cc.Sprite).spriteFrame = self.getPukeSpriteById(puke);\r\n            } else {\r\n                seatPuke.getComponent(cc.Sprite).spriteFrame = self.getPukeSpriteById('pai');\r\n            }\r\n            seatPuke.active = true;\r\n            index += 1;\r\n            self.faPaiAnimation(index);\r\n        })));\r\n    }\r\n}\r\n//----- 搓牌动画\r\nSanGongManager.cuoPaiAnimation = function (type, showType) {\r\n    this.gameUICB.setBtnCuoPaiActive(false);\r\n    this.isCuoPaiComplete = false;\r\n    if (this.copyCuoPai) {\r\n        this.gameUICB.getCuoPaiPool().put(this.copyCuoPai);\r\n    }\r\n    let self = this;\r\n    let seat = this.getSeatByNumber(1);\r\n    let pukeCuo = seat.getChildByName('puke3');\r\n    pukeCuo.active = false;\r\n    this.copyCuoPai = this.gameUICB.getCuoPaiPool().get();\r\n    this.copyCuoPai.setPosition(0, 0);\r\n    this.gameUICB.getChildNode().getChildByName('cuopai').addChild(this.copyCuoPai);\r\n    let data  = {};\r\n    data.from = type;\r\n    data.GameType = 'SANGONG';\r\n    data.num  = this.CuoPaiNumber;\r\n    data.cb   = function(){\r\n        if (type != 'showCard') {\r\n            fun.net.send('ShowCard', '');\r\n        }\r\n        if (showType !== undefined) {\r\n            self.showTypeFunc(seat, showType);\r\n        }\r\n        self.isCuoPaiComplete = true;\r\n        pukeCuo.active = true;\r\n        pukeCuo.getComponent(cc.Sprite).spriteFrame = self.getPukeSpriteById(data.num);\r\n        self.gameUICB.getCuoPaiPool().put(self.copyCuoPai);\r\n    };\r\n    this.copyCuoPai.getComponent('CuoPai').initPuke(data);\r\n}\r\n//----- 初始化抢庄\r\nSanGongManager.initQZhuangFunction = function () {\r\n    if (this.data != undefined && this.data.DZhuang === 3) {\r\n        this.IsFreeQiangZhuang = true;\r\n        this.QiangZhuangSeat   = new Array();\r\n        this.ZeroZhuangSeat    = new Array();\r\n        this.TurnZhuang        = false;\r\n    }\r\n}\r\n//----- 游戏重连 准备显示\r\nSanGongManager.reconnectReadyFunc = function () {\r\n    this.FirstEnterRoom = false;\r\n    if (this.data.Players != undefined) {\r\n        for (let i in this.data.Players) {\r\n            let player = this.data.Players[i];\r\n            let seat = this.getSeatByUserId(player.UserId);\r\n            if (player.Ready) {\r\n                seat.Readying.active = true;\r\n            }\r\n            if (this.checkIsMineUserId(player.UserId) && !player.Ready) {\r\n                this.gameUICB.setBtnReadyActive(true);\r\n            }\r\n        }\r\n    }\r\n}\r\n//----- 检测是否为房主\r\nSanGongManager.getRoomMasterByRoomInfo = function () {\r\n    if (this.data.RoomIdx !== undefined) {\r\n        return this.data.RoomIdx === 0 ? true : false;\r\n    } else {\r\n        let players = this.data.Players;\r\n        for (let key in players) {\r\n            if (this.checkIsMineUserId(players[key].UserId)) {\r\n                return players[key].RoomIdx === 0 ? true : false;\r\n            }\r\n        }\r\n    }\r\n}\r\n//----- 庄显示为 false\r\nSanGongManager.setZhuangFalse = function () {\r\n    for (let i = 0; i < 6; ++i) {\r\n        let seat = this.getSeatByNumber(i+1);\r\n        seat.Zhuang.active = false;\r\n    }\r\n}\r\n//----- 检测是否为自己的UserId\r\nSanGongManager.checkIsMineUserId = function(id){\r\n    if (parseInt(id) === this.MineUserId)\r\n        return true;\r\n    else\r\n        return false;\r\n}\r\n//----- 设置游戏状态\r\nSanGongManager.setState = function(content){\r\n    for(let i=0; i<6; ++i){\r\n        let seat = this.getSeatByNumber(i+1);\r\n        if (seat.active) {\r\n            if (!content) {\r\n                seat.State.active = false;\r\n                this.gameUICB.jumpTextAnim(false);\r\n            } else {\r\n                let seatNumber = this.getSeatNumberByRoomIdx(this.CurrentZhuang);\r\n                if (content === '下注中' && seatNumber === i+1)\r\n                    console.log('庄家不下注');\r\n                else\r\n                    this.gameUICB.setState({state: seat.State, content: content, color: 0});\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n//-----------------------------------------------------------\r\n//----- 初始化 房间 信息\r\nSanGongManager.initRoomInfo = function () {\r\n    this.gameUICB.setGameStatus(this.data.Status);\r\n    this.RoundJuShu = this.data.Round;\r\n    this.TotalJuShu = this.data.Total;\r\n    this.DiFen      = PukeDefine.ROOM_INFO.DI_FEN[this.data.DFeng-1];\r\n    this.ZhuangWei  = PukeDefine.ROOM_INFO.ZHUANG_WEI[this.data.DZhuang-1];\r\n    this.Charge     = PukeDefine.ROOM_INFO.COST[this.data.Charge-1];\r\n    this.IsMaster = PukeDefine.ROOM_INFO.ISMASTER[this.getRoomMasterByRoomInfo() ? 0 : 1];\r\n    let msg = {\r\n        RoomId    : this.data.RoomId,\r\n        Round     : this.RoundJuShu,\r\n        Total     : this.TotalJuShu,\r\n        ZhuangWei : this.ZhuangWei,\r\n        DiFen     : this.DiFen[0],\r\n        IsMaster  : this.IsMaster,\r\n    }\r\n    this.gameUICB.initRoomInfo(msg);\r\n}\r\n//----- 初始化 座位 信息\r\nSanGongManager.initSeatInfo = function () {\r\n    if (this.data.EnterRoom === 'create') {\r\n        this.updateSeatNumber();\r\n        this.gameUICB.setCreateSeat();\r\n    } else if (this.data.EnterRoom === 'enter') {\r\n        this.CardsMap = {};\r\n        this.updateSeatNumber(this.data.Players);\r\n        for(let i=0; i<this.data.Players.length; i++){\r\n            let value      = this.data.Players[i];\r\n            let roomIdx    = value.RoomIdx;\r\n            let seatNumber = this.getSeatNumberByRoomIdx(roomIdx);\r\n            let seat = this.getSeatByNumber(seatNumber);\r\n            if (!value.OnLine){\r\n                seat.Mask.active = true;\r\n            }\r\n            this.gameUICB.setEnterSeat(seatNumber, value);\r\n            if (value.Cards && value.Cards[0] != 0) {\r\n                this.CardsMap[value.UserId] = {};\r\n                this.CardsMap[value.UserId].Cards = value.Cards;\r\n                if(value.Cards.length === 2){\r\n                    for(let i=1; i<=3; i++){\r\n                        let puke = this.getPukeSpriteById('pai');\r\n                        seat['Puke'+i].active = true;\r\n                        seat['Puke'+i].getComponent(cc.Sprite).spriteFrame = puke;\r\n                    }\r\n                } else if (value.Cards.length === 3){\r\n                    for(let i=1; i<=3; i++){\r\n                        let puke = this.getPukeSpriteById(value.Cards[i-1]);\r\n                        seat['Puke'+i].active = true;\r\n                        seat['Puke'+i].getComponent(cc.Sprite).spriteFrame = puke;\r\n                    }\r\n                }\r\n            }\r\n            if (this.checkIsMineUserId(value.UserId)) {\r\n                this.RecentYaZhu = value.Zhu === 0 ? 1 : value.Zhu;\r\n            }\r\n        }\r\n        if (this.data.Zhuang > -1) {\r\n            this.CurrentZhuang = this.data.Zhuang;\r\n            for(let i=1; i<=6; i++){\r\n                let seat = this.getSeatByNumber(i);\r\n                if(seat.RoomIdx === this.data.Zhuang){\r\n                    seat.Zhuang.active = true;\r\n                    seat.ZhuangSp.setAnimation(0, 'Zhong', false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n//----- 开始游戏准备\r\nSanGongManager.startGameReady = function () {\r\n    this.gameUICB.setGameStatus(6);\r\n    this.gameUICB.setBtnInviteActive(false);\r\n    for (let i=1; i<=6; i++){\r\n        let seat = this.getSeatByNumber(i);\r\n        seat.Readying.active = false;\r\n        seat.YaBox.active = false;\r\n    }\r\n}\r\n\r\n//-----------------------------------------------------------\r\n// 监听函数初始化\r\nSanGongManager.initListener = function () {\r\n    this.ListenCBList = [];\r\n    this.pListenCBList = [];\r\n    let self = this;\r\n    let listen = function(cmd, cb, isPingTai){\r\n        if (isPingTai) {\r\n            fun.net.pListen(cmd, cb);\r\n            self.pListenCBList.push(cmd);\r\n        } else {\r\n            fun.net.listen(cmd, cb);\r\n            self.ListenCBList.push(cmd);\r\n        }\r\n    }\r\n    listen('EnterRoom', this.onEnterRoomAck.bind(this), true);\r\n    listen('OnLine',    this.onOnLineAck.bind(this), true);\r\n    listen('OffLine',   this.onOffLineAck.bind(this), true);\r\n    listen('ReadyNext',          this.onReadyNextAck.bind(this));\r\n    listen('Qzhuang',            this.onQZhuangAck.bind(this));\r\n    listen('Zhuang',             this.onZhuangAck.bind(this));\r\n    listen('YaZhu',              this.onYaZhuAck.bind(this));\r\n    listen('SomeOneYaZhu',       this.onSomeOneYaZhuAck.bind(this));\r\n    listen('StartGame',          this.onStartGameAck.bind(this));\r\n    listen('ShowCard',           this.onShowCardAck.bind(this));\r\n    listen('AccountOne',         this.onSingleAccountAck.bind(this));\r\n    listen('AccountAll',         this.onTotalAccountAck.bind(this));\r\n    listen('LeaveRoom',          this.onLeaveRoomAck.bind(this));\r\n    listen('DisbandRoomResult',  this.onDisbandRoomResultAck.bind(this));\r\n    listen('DisbandRoomVote',    this.onDisbandRoomVoteAck.bind(this));\r\n}\r\nSanGongManager.cleanListener = function(){\r\n    for (let i in this.ListenCBList) {\r\n        fun.net.rmListen(this.ListenCBList[i]);\r\n    }\r\n    for (let i in this.pListenCBList) {\r\n        fun.net.rmPListen(this.pListenCBList[i]);\r\n    }\r\n    this.ListenCBList = [];\r\n    this.pListenCBList = [];\r\n}\r\n\r\n//--- 加入房间返回通知\r\nSanGongManager.onEnterRoomAck = function(msg){\r\n    if (this.checkIsMineUserId(msg.Player.UserId)) return;\r\n    if (this.SeatArray === undefined) return;\r\n    let roomIdx = msg.Player.RoomIdx;\r\n    let cha = Math.abs(this.SeatArray[0] - roomIdx);\r\n    if (this.SeatArray[0] > roomIdx) {\r\n        this.SeatArray[6-cha] = roomIdx;\r\n    } else {\r\n        this.SeatArray[cha] = roomIdx;\r\n    }\r\n    this.gameUICB.setEnterSeat(this.getSeatNumberByRoomIdx(roomIdx), msg.Player);\r\n}\r\n//--- 准备返回通知\r\nSanGongManager.onReadyNextAck = function(msg){\r\n    if (!msg) { return; }\r\n    if (this.checkIsMineUserId(msg.UserId)) {\r\n        this.gameUICB.setBtnReadyActive(false);\r\n        this.MineSeat.Readying.active = true;\r\n    } else {\r\n        if (msg.UserId === 0) {\r\n            if (this.FirstEnterRoom) {\r\n                this.reconnectReadyFunc();\r\n            } else {\r\n                this.gameUICB.setBtnReadyActive(true);\r\n            }\r\n        } else {\r\n            let seat = this.getSeatByUserId(msg.UserId);\r\n            seat.Readying.active = true;\r\n            seat.Ying.active = false;\r\n            seat.Shu.active = false;\r\n        }\r\n    }\r\n}\r\n//--- 抢庄通知\r\nSanGongManager.onQZhuangAck = function(msg){\r\n    if (msg.RetCode != undefined) {\r\n        if (msg.RetCode === 0) {\r\n            this.gameUICB.setBtnQZhuangActive(false);\r\n        }\r\n        return;\r\n    }\r\n    this.cleanSeatData();\r\n    if (msg.UserId === 0) {\r\n        Audio.playEffect('pork', 'remind.mp3');\r\n        this.setState('抢庄中');\r\n        this.gameUICB.setBtnInviteActive(false);\r\n        this.gameUICB.setBtnQZhuangActive(true);\r\n        this.gameUICB.showHint(PukeDefine.HINT_TEXT.WAIT_QIANG_ZHUANG);\r\n        for(let i=1; i<=6; i++){\r\n            let seat = this.getSeatByNumber(i);\r\n            if (seat.active) {\r\n                this.ZeroZhuangSeat[this.ZeroZhuangSeat.length] = i;\r\n            }\r\n        }\r\n        this.DingZhuangTime    = 0;\r\n        this.StartChooseZhuang = true;\r\n    } else {\r\n        let seat = this.getSeatByUserId(msg.UserId);\r\n        if (msg.Op === 0) {\r\n            let seatNumber = seat.SeatNumber;\r\n            this.QiangZhuangSeat[this.QiangZhuangSeat.length] = seatNumber;\r\n            this.gameUICB.setState({state: seat.State, content: '已抢庄', color: 0});\r\n        } else if (msg.Op === 1) {\r\n            this.gameUICB.setState({state: seat.State, content: '不抢庄', color: 1});\r\n        }\r\n    }\r\n}\r\n//--- 下发庄家通知\r\nSanGongManager.onZhuangAck = function(msg){\r\n    let self = this;\r\n    this.CurrentZhuang = msg.Zhuang;\r\n    this.setState(false);\r\n    this.gameUICB.showHint(PukeDefine.HINT_TEXT.WAIT_XIA_ZHU);\r\n    this.cleanSeatData();\r\n    let zhuangFunc = function(){\r\n        self.setState('下注中');\r\n        let zhuangSeat = self.getSeatByNumber(self.getSeatNumberByRoomIdx(msg.Zhuang));\r\n        self.gameUICB.setBtnXuYaActive(self.checkIsMineUserId(zhuangSeat.UserId) ? false : true);\r\n        self.startGameReady();\r\n        self.gameUICB.setBtnQZhuangActive(false);\r\n        self.setZhuangFalse();\r\n        zhuangSeat.Zhuang.active = true;\r\n        zhuangSeat.ZhuangSp.setAnimation(0, 'Zhong', false);\r\n    }\r\n    let resetFunc = function(){\r\n        self.TurnZhuang        = false;\r\n        self.ZeroZhuangSeat    = [];\r\n        self.QiangZhuangSeat   = [];\r\n        self.DingZhuangTime    = 0;\r\n        self.StartChooseZhuang = false;\r\n        self.qzDtTime          = 0;\r\n    }\r\n    if (this.IsFreeQiangZhuang && this.QiangZhuangSeat.length != 1) {\r\n        this.DingZhuangTime = PukeDefine.QIANG_ZHUANG_WAIT_TIME;\r\n        this.gameUICB.scheduleOnceFunc(function(){\r\n            resetFunc();\r\n            zhuangFunc();\r\n        }, PukeDefine.QIANG_ZHUANG_TURN_TIME);\r\n    } else if (this.IsFreeQiangZhuang && this.QiangZhuangSeat.length === 1) {\r\n        resetFunc();\r\n        zhuangFunc();\r\n    } else {\r\n        zhuangFunc();\r\n    }\r\n}\r\n//--- 押注提示通知\r\nSanGongManager.onYaZhuAck = function(msg){\r\n    if (msg === undefined || msg.Zhus === null) { return; }\r\n    if (msg.RetCode != undefined) { return; }\r\n    if (this.data.DZhuang !== 3) {\r\n        Audio.playEffect('pork', 'remind.mp3');\r\n    }\r\n    let self = this;\r\n    this.gameUICB.setBtnXiaZhuActive(true);\r\n    this.gameUICB.showHint(PukeDefine.HINT_TEXT.WAIT_XIA_ZHU);\r\n    this.startGameReady();\r\n    this.gameUICB.showXiaZhu(msg.Zhus);\r\n    this.cleanSeatData();  //清理单局结算\r\n    if (this.gameUICB.getIsXuYa() && this.RecentYaZhu) {\r\n        this.gameUICB.scheduleOnceFunc(function(){\r\n            if (self.RecentYaZhu === 1) {\r\n                self.gameUICB.onBtnXiaZhuClicked('', 1);\r\n            } else if (self.RecentYaZhu === 2) {\r\n                self.gameUICB.onBtnXiaZhuClicked('', 2);\r\n            } else if (self.RecentYaZhu === 3) {\r\n                self.gameUICB.onBtnXiaZhuClicked('', 3);\r\n            }\r\n        }, PukeDefine.ZI_DONG_XU_YA_TIME);\r\n    }\r\n}\r\n//--- 押注通知\r\nSanGongManager.onSomeOneYaZhuAck = function(msg){\r\n    if (this.checkIsMineUserId(msg.UserId)) {\r\n        this.gameUICB.setBtnXiaZhuActive(false);\r\n    }\r\n    let seat = this.getSeatByUserId(msg.UserId);\r\n    seat.YaBox.active = true;\r\n    seat.YaZhu.string = msg.Zhu;\r\n    this.gameUICB.setState({state: seat.State, content: '已下注', color: 0});\r\n    this.pushGold(seat.SeatNumber, msg.Zhu);\r\n}\r\n//--- 开始游戏通知\r\nSanGongManager.onStartGameAck = function(msg){\r\n    let self = this;\r\n    this.gameUICB.showHint(false);\r\n    this.setState(false);\r\n    this.isCuoPaiComplete = false;\r\n    this.gameUICB.scheduleOnceFunc(function(){\r\n        self.CardsMap = msg.CardsMap;\r\n        let sortCardsMap = new Array();\r\n        let seatNumber   = self.getSeatNumberByRoomIdx(self.CurrentZhuang);\r\n        for (let userid in msg.CardsMap) {\r\n            for (let i=1; i<=6; i++) {\r\n                let seat = self.getSeatByNumber(i);\r\n                if (seat.UserId === parseInt(userid)) {\r\n                    let cha = seatNumber - seat.SeatNumber;\r\n                    let idx = cha >= 0 ? (cha) : (6 - Math.abs(cha));\r\n                    sortCardsMap[idx] = {};\r\n                    sortCardsMap[idx].UserId = userid;\r\n                    sortCardsMap[idx].Cards  = msg.CardsMap[userid].Cards;\r\n                }\r\n            }\r\n        }\r\n        let pukes = [], idx = -1, seats = [];\r\n        for (let k in sortCardsMap) {\r\n            let value = sortCardsMap[k];\r\n            for (let i=1; i<=6; i++) {\r\n                let seat = self.getSeatByNumber(i);\r\n                seat.Readying.active = false;\r\n                if (seat.UserId === parseInt(value.UserId)) {\r\n                    seats.push(seat);\r\n                    let pos = seat.getPosition();\r\n                    if (i === 1) {\r\n                        seats.myCards = value.Cards;\r\n                        self.CuoPaiNumber = value.Cards[2];\r\n                    }\r\n                    for (let j=1; j<=3; j++) {\r\n                        idx += 1;\r\n                        let fuhao = j === 1 ? -1 : (j === 3 ? 1 : 0);\r\n                        pukes[idx] = {};\r\n                        pukes[idx].x = i === 1 ? (fuhao * 30) : (pos.x + fuhao * 30);\r\n                        pukes[idx].y = i === 1 ? pos.y * 0.8 : pos.y - seat.getContentSize().width/1.58;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        self.faPaiPukes = pukes;\r\n        self.faPaiSeats = seats;\r\n        self.faPaiAnimation(0);\r\n    }, PukeDefine.SEND_CARD_DELAY);\r\n}\r\n//--- 显示牌通知\r\nSanGongManager.onShowCardAck = function(msg){\r\n    let seat = this.getSeatByUserId(msg.UserId);\r\n    this.gameUICB.setState({state: seat.State, content: '已亮牌', color: 0});\r\n    let showType = {Dian: msg.Dian, Bei: msg.Bei}\r\n    if (msg.UserId === seat.UserId) {\r\n        if (this.checkIsMineUserId(msg.UserId)) {\r\n            this.CuoPaiNumber = msg.Card;\r\n            if(!this.isCuoPaiComplete){\r\n                this.cuoPaiAnimation('showCard', showType);\r\n            } else {\r\n                this.showTypeFunc(seat, showType);\r\n            }\r\n        } else {\r\n            for (let id in this.CardsMap) {\r\n                if (parseInt(id) === msg.UserId) {\r\n                    for (let i = 1; i <= 2; i++){\r\n                        let puke = this.getPukeSpriteById(this.CardsMap[id].Cards[i-1]);\r\n                        seat['Puke'+i].getComponent(cc.Sprite).spriteFrame = puke;\r\n                    }\r\n                }\r\n            }\r\n            let puke = this.getPukeSpriteById(msg.Card);\r\n            seat['Puke3'].getComponent(cc.Sprite).spriteFrame = puke;\r\n            this.showTypeFunc(seat, showType);\r\n        }\r\n    }\r\n}\r\n//--- 点数倍数显示\r\nSanGongManager.showTypeFunc = function (seat, value) {\r\n    let anim  = value.Dian;\r\n    let effectName;\r\n    if (value.Bei === 1 || value.Bei === 2 || value.Bei === 3) {\r\n        anim = value.Dian + 'dian';\r\n        effectName = value.Dian;\r\n    } else if (value.Bei === 4) {\r\n        anim = 'Hun';\r\n        effectName = 10;\r\n    } else if (value.Bei === 5) {\r\n        anim = 'Fei';\r\n        effectName = 11;\r\n    } else if (value.Bei === 6) {\r\n        anim = 'Da';\r\n        effectName = 12;\r\n    } else if (value.Bei === 9) {\r\n        anim = 'Tian';\r\n        effectName = 13;\r\n    }\r\n    seat.ShuZi.active = true;\r\n    seat.ShuZiSp.setAnimation(0, anim, false);\r\n    if (this.checkIsMineUserId(seat.UserId)){\r\n        let type = PukeDefine.NIUNIU_ROOM_INFO.PAI_JU_SCORE['SAN_GONG'][effectName];\r\n        let sex = this.UserInfo.Sex === 1 ? 'male' : 'female';\r\n        Audio.playEffect('pork', type+'.mp3', sex);\r\n    }\r\n}\r\n//--- 单局结算通知\r\nSanGongManager.onSingleAccountAck = function(msg){\r\n    this.setState(false);\r\n    let accountMap = msg.AccountMap;\r\n    let userArr    = {};\r\n    let winSeats   = new Array();\r\n    for (let id in accountMap) {\r\n        let value  = accountMap[id];\r\n        let winSeat   = this.getSeatByUserId(id);\r\n        winSeat.Slice = value.Slice;\r\n        winSeats[winSeats.length] = winSeat;\r\n        let loseSeatArr = new Array();\r\n        for (let i in value.Slice) {\r\n            let slice  = value.Slice[i];\r\n            let loseId = slice.UserId;\r\n            let score  = slice.Score;\r\n            loseSeatArr[i] = this.getSeatByUserId(loseId);\r\n            winSeat.Fen.string = parseInt(winSeat.Fen.string) + score;\r\n            loseSeatArr[i].Fen.string = parseInt(loseSeatArr[i].Fen.string) - score;\r\n            userArr[id] = userArr[id] ? (userArr[id] + score) : score;\r\n            userArr[loseId] = userArr[loseId] ? (userArr[loseId] - score) : (-score);\r\n        }\r\n    }\r\n    this.callInGold(winSeats);\r\n    for(let id in userArr) {\r\n        let value = userArr[id];\r\n        let seat  = this.getSeatByUserId(id);\r\n        if (value > 0) {\r\n            seat.Ying.active      = true;\r\n            seat.Shu.active       = false;\r\n            seat.YingLabel.string = '+' + value;\r\n        } else {\r\n            seat.Ying.active      = false;\r\n            seat.Shu.active       = true;\r\n            seat.ShuLabel.string  = value;\r\n        }\r\n    }\r\n    for (let id in msg.BeiDianMap) {\r\n        let value = msg.BeiDianMap[id];\r\n        let seat  = this.getSeatByUserId(id);\r\n        if (!seat.ShuZi) {\r\n            this.showTypeFunc(seat, value);\r\n        }\r\n    }\r\n    this.RoundJuShu += 1;\r\n    if (this.RoundJuShu <= this.TotalJuShu) {\r\n        this.gameUICB.showHint(PukeDefine.HINT_TEXT.WAIT_READY);\r\n        this.gameUICB.setBtnReadyActive(true);\r\n        this.gameUICB.setJuShuText(this.RoundJuShu + '/' + this.TotalJuShu);\r\n    }\r\n}\r\n//--- 总结算通知\r\nSanGongManager.onTotalAccountAck = function(msg){\r\n    msg.RoomId       = this.data.RoomId;\r\n    msg.JuShu        = this.TotalJuShu;\r\n    msg.DiFen        = this.DiFen[0];\r\n    msg.ZhuangWei    = this.ZhuangWei;\r\n    msg.highestScore = 0;\r\n    let self = this;\r\n    let count         = -1;\r\n    let newData       = new Array();\r\n    for (let id in msg.Accounts) {\r\n        let value = msg.Accounts[id];\r\n        let seat = this.getSeatByUserId(id);\r\n        msg.highestScore    = Math.max(value, msg.highestScore);\r\n        count++;\r\n        newData[count]       = {};\r\n        newData[count].id    = id;\r\n        newData[count].score = value;\r\n        // newData[count].name  = seat.Name.string;\r\n        newData[count].name  = seat._Name;\r\n        newData[count].head  = seat.HeadUrl;\r\n        newData[count].left  = msg.RoomCards[id].Left;\r\n        newData[count].lost  = msg.RoomCards[id].Lost;\r\n    }\r\n    newData.sort(function(a, b){ return a.score < b.score; });\r\n    msg.sortAccounts = newData;\r\n\r\n    this.gameUICB.showHint(PukeDefine.HINT_TEXT.WAIT_TOTAL_ACCOUNT);\r\n    let time = PukeDefine.TOTAL_ACCOUNT_SHOW_TIME;\r\n    if (this.copyDisbandPrefab) {\r\n        this.copyDisbandPrefab.removeFromParent();\r\n        time = 0.1;\r\n    }\r\n    this.copyTotalAccount = this.gameUICB.onTotalAccountAck();\r\n    this.copyTotalAccount.setPosition(0, 0);\r\n    this.gameUICB.setCountDownTime(true, time);\r\n    this.gameUICB.scheduleOnceFunc(function(){\r\n        self.gameUICB.setCountDownTime(false);\r\n        self.gameUICB.showHint(false);\r\n        self.gameUICB.getChildNode().getChildByName('totalaccount').addChild(self.copyTotalAccount);\r\n        self.copyTotalAccount.getComponent('PukeAccount').initTotalAccount(msg);\r\n    }, time);\r\n}\r\n\r\n// 离开(解散)房间\r\nSanGongManager.onLeaveRoomAck = function(msg){\r\n    if (msg.UserId && msg.UserId >= 0) {\r\n        let seat = this.getSeatByUserId(msg.UserId);\r\n        let pukeNumber = PukeDefine.GAME_TYPE[this.data.GameType].PUKE_NUMBER;\r\n        this.gameUICB.resetSeat(seat.SeatNumber, pukeNumber);\r\n    }\r\n}\r\nSanGongManager.onDisbandRoomResultAck = function(msg){\r\n    let self = this;\r\n    this.gameUICB.setMenuBgActive(false);\r\n    if (msg.Disbanded) {\r\n        this.gameUICB.scheduleOnceFunc(function(){\r\n            if (!self.copyTotalAccount) {\r\n                cc.director.loadScene('hall');\r\n            }\r\n        }, PukeDefine.DISBAND_ROOM_DELAY_TIME);\r\n    } else {\r\n        this.gameUICB.scheduleOnceFunc(function(){\r\n            if (self.copyDisbandPrefab) {\r\n                self.copyDisbandPrefab.active = false;\r\n            }\r\n        }, PukeDefine.DISBAND_ROOM_DELAY_TIME);\r\n    }\r\n}\r\nSanGongManager.onDisbandRoomVoteAck = function(msg){\r\n    if (!msg) { return; }\r\n    if (msg.RetCode !== undefined) {\r\n        if (msg.RetCode === 0) {\r\n            cc.director.loadScene('hall');\r\n        }\r\n        return;\r\n    }\r\n    if (!this.copyDisbandPrefab) {\r\n        this.copyDisbandPrefab = this.gameUICB.getDisband();\r\n    }\r\n    this.gameUICB.setMenuBgActive(false);\r\n    this.copyDisbandPrefab.active = true;\r\n    msg.GameType = 'sangong';\r\n    for (let i = 1; i <= 6; i++) {\r\n        let seat = this.getSeatByNumber(i);\r\n        for (let id in msg.VoteInfo) {\r\n            if (id == seat.UserId) {\r\n                let state = msg.VoteInfo[id];\r\n                msg.VoteInfo[id] = {};\r\n                msg.VoteInfo[id].state = state;\r\n                msg.VoteInfo[id].name = seat.Name.string;\r\n                msg.VoteInfo[id].headUrl = seat.HeadUrl;\r\n            }\r\n        }\r\n    }\r\n    this.copyDisbandPrefab.getComponent('PukeDisband').disbandRoomInit(msg);\r\n}\r\n// 上线 离线\r\nSanGongManager.onOnLineAck = function(msg){\r\n    let seat = this.getSeatByUserId(msg.UserId);\r\n    seat.Mask.active = false;\r\n}\r\nSanGongManager.onOffLineAck = function(msg){\r\n    let seat = this.getSeatByUserId(msg.UserId);\r\n    seat.Mask.active = true;\r\n}\r\n\r\n//-----------------------------------------------------------\r\n//--- 押注大小\r\nSanGongManager.YaZhuFunction = function (yanum) {\r\n    this.RecentYaZhu = parseInt(yanum);\r\n    fun.net.send('YaZhu', {Zhu : this.DiFen[yanum-1]}, function(rsp){\r\n        if (rsp.RetCode !== undefined && rsp.RetCode != 0) {\r\n            this.gameUICB.setBtnXiaZhuActive(false);\r\n        }\r\n    }.bind(this));\r\n}\r\n//--- 离开(解散)房间\r\nSanGongManager.LeaveRoomFunction = function () {\r\n    if (this.gameUICB.getGameStatus() === 1) {\r\n        if (this.MineIsMaster) {\r\n            fun.net.send('DisbandRoomVote', {OP : 1}, function(rsp){\r\n                if (rsp.RetCode !== undefined && rsp.RetCode === 0) {\r\n                    cc.director.loadScene('hall');\r\n                }\r\n            }.bind(this));\r\n        } else {\r\n            fun.net.send('LeaveRoom', {OP : 1}, function(rsp){\r\n                if(rsp.Leave){\r\n                    cc.director.loadScene('hall');\r\n                }\r\n            }.bind(this));\r\n        }\r\n    } else {\r\n        fun.net.send('DisbandRoomVote', {OP : 1});\r\n    }\r\n}\r\n//--- 准备\r\nSanGongManager.ReadyFunction = function () {\r\n    fun.net.send('ReadyNext', '', function(rsp){\r\n        if (rsp.RetCode !== undefined && rsp.RetCode === 0) {\r\n            this.gameUICB.setBtnReadyActive(false);\r\n            this.MineSeat.Readying.active = true;\r\n        }\r\n    }.bind(this));\r\n}\r\n//--- 抢庄\r\nSanGongManager.QZhuangFunction = function (type) {\r\n    fun.net.send('Qzhuang', {OP : type}, function(rsp){\r\n        if (rsp.RetCode !== undefined && rsp.RetCode === 0) {\r\n            this.gameUICB.setBtnQZhuangActive(false);\r\n        }\r\n    }.bind(this));\r\n}\r\n//--- 微信分享\r\nSanGongManager.wxShare = function () {\r\n    let jushu    = this.TotalJuShu + '局';\r\n    let difen    = '底分' + this.DiFen[0];\r\n    let info     = {};\r\n    info.title   = '三公-房间号：' + this.data.RoomId;\r\n    info.content = jushu + ', ' + this.Charge + ', ' + this.ZhuangWei + ', ' + difen;\r\n    require('JSPhoneWeChat').WxShareFriend(info);\r\n}\r\n\r\nmodule.exports = SanGongManager;"]}
{"version":3,"sources":["../../../../../../assets/hall/script/public/assets/hall/script/public/playerMap.js"],"names":["cc","Class","extends","Component","properties","onLoad","animation","node","getComponent","Animation","clips","getClips","backN","getChildByName","start","close","play","name","once","destroy","getDistance","meIdx","targetIdx","mData","players","targetData","distance","creatDistanceData","dColor","Color","RED","showDistance","Math","floor","YELLOW","toFixed","GREEN","color","Address","sys","isNative","points","p1","p2","require","getDistanceByPoints","setDistance","lineN","distanceData","bgN","contentN","Label","string","show","i","playerN","playerData","iconN","mainN","waitN","active","undefined","fun","utils","loadUrlRes","Icon","idx"],"mappings":"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","file":"playerMap.js","sourceRoot":"../../../../../../assets/hall/script/public","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.animation   = this.node.getComponent(cc.Animation);\n        this.clips       = this.animation.getClips();\n        this.backN       = this.node.getChildByName(\"back\");\n    },\n\n    start () {\n\n    },\n\n    close (){\n        this.animation.play(this.clips[1].name).once('finished', function () {\n            this.node.destroy();\n        }, this);\n    },\n\n    getDistance : function(meIdx, targetIdx){\n        var mData        = this.players[meIdx];\n        var targetData   = this.players[targetIdx];\n        var distance     = -1;\n        var creatDistanceData = function(){\n            var dColor       = cc.Color.RED;\n            var showDistance = Math.floor(distance) + \"米\";\n            if(distance < 0){\n                showDistance = \"距离未知\"\n                dColor       = cc.Color.YELLOW;\n            }\n            if(distance > 1000){\n                showDistance = (distance /1000).toFixed(2) + \"千米\";\n                dColor       = cc.Color.GREEN;\n            }\n            return {color : dColor, distance : showDistance};\n        }\n        //任何一方没有数据\n        if(!(mData && targetData && mData.Address && targetData.Address) || !cc.sys.isNative) {\n            return creatDistanceData();\n        }\n        let points = {p1:mData.Address, p2:targetData.Address};\n        distance = require('JSPhoneBaiDu').getDistanceByPoints(points) \n        return creatDistanceData()\n    },\n\n     setDistance : function(lineN, meIdx, targetIdx){\n        var distanceData = this.getDistance(meIdx, targetIdx);\n        var bgN          = lineN.getChildByName(\"bg\");\n        var contentN     = lineN.getChildByName(\"distance\").getChildByName(\"content\");\n        bgN.color        = distanceData.color;\n        contentN.color   = distanceData.color;\n        contentN.getComponent(cc.Label).string = distanceData.distance\n    },\n\n\n\n    show(players){\n        this.players = players;\n        for(let i=0; i<4; i++){\n            var playerN    = this.backN.getChildByName(\"player_\"+i);\n            var playerData = players[i];\n            var iconN      = playerN.getChildByName(\"icon\")\n            var mainN      = iconN.getChildByName(\"main\");\n            var waitN      = iconN.getChildByName(\"wait\")\n            mainN.active   = (playerData != undefined);\n            waitN.active   = (playerData == undefined);\n            if(playerData){  \n                var contentN = mainN.getChildByName(\"content\");\n                fun.utils.loadUrlRes(playerData.Icon, contentN)\n            }\n            for(let idx =0; idx<4; idx++){\n                if(idx == i){\n                    continue;\n                }\n                var lineN = playerN.getChildByName(\"line_\"+idx);\n                if(lineN){\n                    this.setDistance(lineN, i, idx);\n                }\n            }\n        }\n    },\n\n    // update (dt) {},\n});\n"]}
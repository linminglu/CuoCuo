{"version":3,"sources":["../../../../../../assets/hall/script/public/assets/hall/script/public/updatePanel.js"],"names":["cc","Class","extends","Component","properties","progressNode","type","Node","default","btnUpdate","gressNode","content","Label","tipsNode","sizeNode","checkingUpdate","onLoad","gressLabel","getComponent","progressBar","ProgressBar","animation","node","Animation","clips","getClips","onEnable","play","name","onDisable","setVersionContent","data","updateCb","string","replace","active","once","onBtnUpdateClick","setSourceSize","size","sizeStr","toFixed","cont","getChildByName","setPositionX","getPositionX","getContentSize","width","require","playEffect","updateProgress","percent","progress","percentStr"],"mappings":"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","file":"updatePanel.js","sourceRoot":"../../../../../../assets/hall/script/public","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        progressNode: {\n            type: cc.Node,\n            default: null,\n        },\n\n        btnUpdate: {\n            type: cc.Node,\n            default: null,\n        },\n\n        gressNode: {\n            type: cc.Node,\n            default: null,\n        },\n\n        content: {\n            type: cc.Label,\n            default: null,\n        },\n\n        tipsNode: {\n            type: cc.Node,\n            default: null,\n        },\n\n        sizeNode: {\n            type: cc.Node,\n            default: null,\n        },\n\n        checkingUpdate: {\n            type: cc.Node,\n            default: null,\n        },\n    },\n\n    onLoad () {\n        this.gressLabel = this.gressNode.getComponent(cc.Label);\n        this.progressBar = this.progressNode.getComponent(cc.ProgressBar);\n\n        this.animation = this.node.getComponent(cc.Animation);\n        this.clips = this.animation.getClips();\n    },\n\n    onEnable () {\n        this.animation.play(this.clips[0].name);\n    },\n\n    onDisable () {\n        this.animation.play(this.clips[1].name);\n    },\n\n    setVersionContent (data, updateCb) {\n        this.content.string = data[0].replace(/\\\\n/g, \"\\n\");\n        this.updateCb = updateCb;\n        this.btnUpdate.active = true;\n        this.btnUpdate.once('click', this.onBtnUpdateClick, this);\n        this.checkingUpdate.active = false;\n    },\n\n    setSourceSize (size) {\n        this.tipsNode.active = false;\n        this.gressNode.active = true;\n        this.sizeNode.active = true;\n        const sizeStr = size.toFixed(2);\n        let cont = this.sizeNode.getChildByName('content');\n        cont.getComponent(cc.Label).string = sizeStr;\n        this.sizeNode.getChildByName('end').setPositionX(cont.getPositionX() + cont.getContentSize().width + 5);\n    },\n\n    onBtnUpdateClick () {\n        require('Audio').playEffect('hall', 'button_nomal.mp3');\n        if (this.updateCb) {\n            this.updateCb();\n        }\n        this.tipsNode.active = true;\n        this.progressNode.active = true;\n        this.btnUpdate.active = false;\n    },\n\n    updateProgress (percent = 0) {\n        this.progressBar.progress = percent;\n        let percentStr = (percent * 100).toFixed(2) + \"%\";\n        if (percentStr === \"NaN%\") {\n            percentStr = '0%';\n        }\n        this.gressLabel.string = percentStr;\n    },\n\n});\n"]}
{"version":3,"sources":["../../../../../../../assets/mahjong/script/game/common/assets/mahjong/script/game/common/mjAnimHelper.js"],"names":["cc","Class","extends","Component","properties","onLoad","spAnim","node","getComponent","sp","Skeleton","self","completeFunc","event","onAnimFinish","setCompleteListener","initSpecialEndAnim","initOptPaiAnim","initCommonAnim","onFinishCB","undefined","removeFromParent","creatAnimObj","keyName","animName","key","name","animList","push","endAnimList","GameDefine","require","optDefine","EATPAI_TYPE","namelist","ChiPai","PengPai","MingGang2","AnGang","MingGang1","BuHua","optPaiAnimList","showSpeacilEndAnim","endData","endAninName","i","length","animObj","setAnimation","showOptPaiAnim","eatType","commonList","commonAnimList","showCommonAnim","handler","progress","onFinish","EventHandler","emitEvents","finishHandler"],"mappings":"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","file":"mjAnimHelper.js","sourceRoot":"../../../../../../../assets/mahjong/script/game/common","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n    },\n\n\n\n    \n    // use this for initialization\n    onLoad: function () {\n        this.spAnim = this.node.getComponent(sp.Skeleton);\n        var self = this;\n        var completeFunc = function(event){\n            self.onAnimFinish(event)\n        }\n        this.spAnim.setCompleteListener(completeFunc);\n        this.initSpecialEndAnim();\n        this.initOptPaiAnim();\n        this.initCommonAnim();\n    },\n\n    onAnimFinish : function(event){\n        if(this.onFinishCB){\n            this.onFinishCB();\n        }\n        this.onFinishCB = undefined;\n        this.node.removeFromParent();\n    },\n\n    initSpecialEndAnim : function(){\n        var creatAnimObj = function(keyName, animName){\n            return {key : keyName, name : animName}\n        }\n        var animList = [];\n        //显示优先级依次为：清一色、混一色、杠上开花、对对胡、自摸、胡\n        //比如：清一色自摸，就只显示清一色，不显示自摸\n        animList.push(creatAnimObj(\"isqys\", \"Qingyise\")); //清一色\n        animList.push(creatAnimObj(\"ishys\", \"Hunyise\"));  //混一色\n        animList.push(creatAnimObj(\"isgsh\", \"Gangshangkaihua\")); //杠上开花\n        animList.push(creatAnimObj(\"isddh\", \"Duiduihu\")); //对对胡\n        animList.push(creatAnimObj(\"iszm\", \"Zimo\"))  //自摸\n        this.endAnimList = animList;\n    },\n\n    initOptPaiAnim : function(){\n        var GameDefine                = require(\"mjGameDefine\");\n        var optDefine                 = GameDefine.EATPAI_TYPE;\n        var namelist                  = {};\n        namelist[optDefine.ChiPai]    = \"Chi\";\n        namelist[optDefine.PengPai]   = \"Peng\";\n        namelist[optDefine.MingGang2] = \"Gang\";\n        namelist[optDefine.AnGang]    = \"Gang\";\n        namelist[optDefine.MingGang1] = \"Gang\";\n        namelist[optDefine.BuHua]     = \"Buhua\";\n        this.optPaiAnimList           = namelist;\n    },\n\n    showSpeacilEndAnim : function(endData){\n        var endAninName = \"Hu\";\n        for(let i =0; i<this.endAnimList.length; i++){\n            var animObj = this.endAnimList[i];\n            if( endData[ animObj.key ] ){\n                endAninName = animObj.name;\n                break;\n            }\n        }\n        this.spAnim.setAnimation(0, endAninName, false); \n    },\n\n    showOptPaiAnim : function(eatType){\n         this.spAnim.setAnimation(0, this.optPaiAnimList[eatType], false); \n    },\n\n    initCommonAnim : function(){\n        var commonList         = {};\n        commonList[\"AnimShengpai\"] = \"Shengpai\";\n        commonList[\"AnimLiuju\"]    = \"Liuju\";\n        commonList[\"AnimKaishi\"]   = \"Kaishi\";\n        this.commonAnimList    = commonList;\n    },\n\n    showCommonAnim : function(key, handler){\n        var animName = this.commonAnimList[key];\n        if(!animName){\n            this.node.removeFromParent();\n        }else {\n            this.onFinishCB = handler;\n            // if(animName == \"AnimLiuju\"){\n            //     cc.log(\"sssAnimLiuju \");\n            //     this.node.getChildByName(\"liuju\").active = true;\n            //     var anim = this.node.getChildByName(\"liuju\").getComponent(sp.Skeleton);\n            //     anim.setAnimation(0, animName, false);\n            // }else {\n                this.spAnim.setAnimation(0, animName, false);\n            // }\n            \n        }\n    },\n\n\n\n    progress : function(){\n       // cc.Component.EventHandler.emitEvents([this.fireHandler]);\n    },\n    \n    \n    onFinish : function(){\n        cc.Component.EventHandler.emitEvents([this.finishHandler]);\n    },\n});\n"]}
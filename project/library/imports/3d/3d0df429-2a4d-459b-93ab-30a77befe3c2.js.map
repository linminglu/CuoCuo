{"version":3,"sources":["../../../../../../assets/hall/script/createRoom/assets/hall/script/createRoom/createSanGongRoom.js"],"names":["PukeDefine","require","Audio","cc","Class","extends","Component","properties","FangFei","Node","JuShu","Label","CurrentCard","RoomCard","DingZhuang","DiFen","ShiXian","TeShu","onLoad","fun","gameCfg","releaseType","gameConst","apple","down","node","getChildByName","active","createN","createInfo","utils","getCreateRoomData","gameType","sanGong","setToggleChecked","Charge","DZhuang","DFeng","TimeLimit","string","Total","setMuToggleNotChecked","i","Special","length","getComponent","Toggle","isChecked","animation","Animation","clips","getClips","onEnable","play","name","value","children","onBtnLessClicked","playEffect","juShu","parseInt","CREATE_JUSHU_MIN","CREATE_JUSHU_SPACE","onBtnAddClicked","CREATE_JUSHU_MAX","onBtnCreateClicked","data","togFF","togTS","toggle","togDZ","togSX","GameType","Address","db","getData","location","Zone","net","pSend","rsp","RetCode","undefined","event","dispatch","contentStr","EnterRoom","setData","saveCreateRoomData","director","preloadScene","loadScene","bind","onBtnRechargeClicked","log","onBtnCloseClick","once","destroy"],"mappings":"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","file":"createSanGongRoom.js","sourceRoot":"../../../../../../assets/hall/script/createRoom","sourcesContent":["let PukeDefine = require('PukeDefine');\nlet Audio = require('Audio');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        FangFei     : cc.Node,\n        JuShu       : cc.Label,\n        CurrentCard : cc.Label,\n        RoomCard    : cc.Label,\n        DingZhuang  : cc.Node,\n        DiFen       : cc.Node,\n        ShiXian     : cc.Node,\n        TeShu       : cc.Node,\n    },\n\n    onLoad () {\n        if(fun.gameCfg.releaseType === gameConst.releaseType.apple){\n            let down = this.node.getChildByName('back').getChildByName('down');\n            down.getChildByName('btnRecharge').active = false;\n            let createN = down.getChildByName('btnCreateRoom');\n            createN.getChildByName('text').active = false;\n            createN.getChildByName('num').active = false;\n        }\n        let createInfo = fun.utils.getCreateRoomData(gameConst.gameType.sanGong);\n        if (createInfo) {\n            this.setToggleChecked('FangFei', createInfo.Charge);\n            this.setToggleChecked('DingZhuang', createInfo.DZhuang);\n            this.setToggleChecked('DiFen', createInfo.DFeng);\n            this.setToggleChecked('ShiXian', createInfo.TimeLimit + 1);\n            this.JuShu.string = (createInfo.Total + 1) * 5;\n            this.setMuToggleNotChecked();\n            for (let i = 0; i < createInfo.Special.length; ++i){\n                this.TeShu.getChildByName('toggle'+createInfo.Special[i]).getComponent(cc.Toggle).isChecked = true;\n            }\n        }\n        this.RoomCard.string = this.JuShu.string;\n\n        this.animation = this.node.getComponent(cc.Animation);\n        this.clips = this.animation.getClips();\n    },\n\n    onEnable () {\n        this.animation.play(this.clips[0].name);\n    },\n\n    setToggleChecked : function (name, value) {\n        for (let i = 0; i < this[name].children.length; ++i) {\n            this[name].getChildByName('toggle' + (i+1)).getComponent(cc.Toggle).isChecked = false;\n        }\n        this[name].getChildByName('toggle'+value).getComponent(cc.Toggle).isChecked = true;\n    },\n\n    setMuToggleNotChecked : function () {\n        for (let i = 0; i < this.TeShu.children.length; ++i){\n            this.TeShu.getChildByName('toggle'+(i+1)).getComponent(cc.Toggle).isChecked = false;\n        }\n    },\n\n    // 减少局数\n    onBtnLessClicked : function () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        let juShu = parseInt(this.JuShu.string);\n        if (juShu > PukeDefine.CREATE_JUSHU_MIN) {\n            this.JuShu.string = juShu - PukeDefine.CREATE_JUSHU_SPACE;\n            this.RoomCard.string = this.JuShu.string;\n        }\n    },\n\n    // 增加局数\n    onBtnAddClicked : function () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        let juShu = parseInt(this.JuShu.string);\n        if (juShu < PukeDefine.CREATE_JUSHU_MAX) {\n            this.JuShu.string = juShu + PukeDefine.CREATE_JUSHU_SPACE;\n            this.RoomCard.string = this.JuShu.string;\n        }\n    },\n\n    // 三公创建房间\n    onBtnCreateClicked : function () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        let data = {};\n        data.Special = [];\n        for (let i=1; i<=2; i++) {\n            let togFF = this.FangFei.getChildByName(\"toggle\"+i).getComponent(cc.Toggle);\n            if (togFF.isChecked) {\n                data.Charge = i; //房费\n            }\n            let togTS = this.TeShu.getChildByName(\"toggle\"+i).getComponent(cc.Toggle);\n            if (togTS.isChecked) {\n                data.Special[data.Special.length] = i; //特殊\n            }\n        }\n        for (let i=1; i<=3; i++) {\n            let toggle = this.DiFen.getChildByName(\"toggle\"+i).getComponent(cc.Toggle);\n            if (toggle.isChecked) {\n                data.DFeng = i; //底分\n                break;\n            }\n        }\n        for (let i=1; i<=4; i++) {\n            let togDZ = this.DingZhuang.getChildByName(\"toggle\"+i).getComponent(cc.Toggle);\n            if (togDZ.isChecked) {\n                data.DZhuang = i; //定庄\n            }\n            let togSX = this.ShiXian.getChildByName(\"toggle\"+i).getComponent(cc.Toggle);\n            if (togSX.isChecked) {\n                data.TimeLimit = i-1; //时限\n            }\n        }\n        data.GameType = gameConst.gameType.sanGong; //游戏种类 - 三公\n        data.Address  = fun.db.getData('UserInfo').location;\n        data.Zone     = 0; //是否分区\n        data.Total    = parseInt(this.JuShu.string)/5 - 1; //总局数\n        fun.net.pSend('CreateRoom', data, function(rsp){\n            if (rsp.RetCode !== undefined && rsp.RetCode !== 0) {\n                fun.event.dispatch('Zhuanquan', false);\n                if (rsp.RetCode === 10) {\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: '服务未开启'});\n                } else if (rsp.RetCode === 16) {\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: '房间配置错误'});\n                } else if (rsp.RetCode === 17) {\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: '房卡不足'});\n                } else {\n                    fun.event.dispatch('MinSingleButtonPop', {contentStr: '创建房间失败'});\n                }\n            } else {\n                rsp.EnterRoom = 'create';\n                fun.db.setData('RoomInfo', rsp);\n                fun.utils.saveCreateRoomData(data);\n                cc.director.preloadScene('puke', function(){\n                    fun.event.dispatch('Zhuanquan', false);\n                    cc.director.loadScene('puke');\n                })\n            }\n        }.bind(this));\n    },\n\n    // 房卡充值\n    onBtnRechargeClicked () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        cc.log('房卡')\n    },\n\n    onBtnCloseClick () {\n        Audio.playEffect('hall', 'button_close.mp3');\n        this.animation.play(this.clips[1].name).once('finished', function(){\n            this.node.destroy();\n        }, this);\n    }\n});\n"]}
{"version":3,"sources":["../../../../../../assets/hall/script/hall/assets/hall/script/hall/hall.js"],"names":["GameCfg","require","Audio","cc","Class","extends","Component","properties","createMajiangRoomHY","type","Prefab","default","createMajiangRoomWL","createSanGongRoomPre","createNiuNiuRoomPre","createRoomWahua","zhanjiLayerPre","activityPre","hallSharePre","moreGamePre","newsLayerPre","renzhengPre","setPanelPre","storePre","onLoad","_isTestnet","fun","gameCfg","loginUrl","gameConst","loginUrlType","test","_isIntranet","intranet","_isRelease","releaseType","release","_isApple","apple","sys","isNative","getBaiDuLocation","enterRoomHandle","addEnterRoomHandle","gameType","universal","platformEnterRoomHandle","bind","maJiangHuangYan","mahjongEnterRoomHandle","maJiangWenLing","digFlower","digFlowerEnterRoomHandle","net","setGameMsgCfg","voiceLanguage","localStorage","getItem","valumeData","JSON","parse","s","sound","m","music","soundValume","musicValume","_mainBasic","node","getChildByName","upNode","renzhengBtn","on","onRenzhengBtnClick","head","onHeadClick","userInfo","db","getData","showUserInfo","RoomId","enterRoom","initNode","setTimeout","getNeedNotice","notice","getComponent","Animation","play","active","setNeedNotice","animState","once","leftNode","onBtnJoinClick","gameBtns","rightNode","i","onBtnGameClick","appleReview","push","length","buttomNode","onRecordBtnClick","onShareBtnClick","onSetBtnClick","onActiveBtnClick","newsBtn","onNewsBtnClick","redPoint","onNewMailIdIn","playMusic","Label","string","version","event","add","onReplayInfoIn","applePayStr","onPhonePayResultAck","buttom","setPositionX","setPositionY","getPositionY","btnJoin","setPosition","p","msg","check","pSend","ReceiptStr","receipt","data","RetCode","Status","setItem","stringify","handler","roomId","dispatch","flag","text","Address","location","rsp","GameType","contentStr","pRetCode","returnStatu","setData","director","loadScene","gameTypeSceneNameMap","codeCfg","mjGameDefine","HYRETCODE","WLRETCODE","EnterRoom","self","gotoStore","showStore","okBtnStr","okCb","isApple","isIntranet","store","instantiate","parent","setGameType","playEffect","renzheng","UserName","UserId","utils","loadUrlRes","UserHeadUrl","record","base64","decode","setReplayData","mId","index","Total","undefined","hyNode","showRoomCard","wlNode","nnNode","sgNode","onBtnGameMoreClick","gameMore","Start","zhanjiLayer","init","Type","itemCsv","voucher","hallShare","setLeftTicket","Cnt","news","Page","Count","mInfos","setPanel","activity","enter","x","y","onStoreBtnClick","onDestroy","remove","stopMusic"],"mappings":"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","file":"hall.js","sourceRoot":"../../../../../../assets/hall/script/hall","sourcesContent":["let GameCfg = require('GameCfg')\nlet Audio = require('Audio');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        createMajiangRoomHY: {\n            type: cc.Prefab,\n            default: null,\n        },\n        createMajiangRoomWL: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        createSanGongRoomPre : {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        createNiuNiuRoomPre : {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        createRoomWahua : {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        zhanjiLayerPre: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        activityPre: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        hallSharePre: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        moreGamePre: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        newsLayerPre: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        renzhengPre: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        setPanelPre: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        storePre: {\n            type: cc.Prefab,\n            default: null,\n        },\n    },\n\n    onLoad () {\n        //测试\n            \n        //\n\n        this._isTestnet = fun.gameCfg.loginUrl === gameConst.loginUrl[gameConst.loginUrlType.test] ? true : false;\n        this._isIntranet = fun.gameCfg.loginUrl === gameConst.loginUrl[gameConst.loginUrlType.intranet] ? true : false;\n        this._isRelease = fun.gameCfg.releaseType === gameConst.releaseType.release ? true : false;\n        this._isApple = fun.gameCfg.releaseType === gameConst.releaseType.apple ? true : false;\n        if (cc.sys.isNative) {\n            require('JSPhoneBaiDu').getBaiDuLocation();\n        }\n        this.enterRoomHandle = [];\n        this.addEnterRoomHandle(gameConst.gameType.universal, this.platformEnterRoomHandle.bind(this));\n        this.addEnterRoomHandle(gameConst.gameType.maJiangHuangYan, this.mahjongEnterRoomHandle.bind(this));\n        this.addEnterRoomHandle(gameConst.gameType.maJiangWenLing, this.mahjongEnterRoomHandle.bind(this));\n        this.addEnterRoomHandle(gameConst.gameType.digFlower, this.digFlowerEnterRoomHandle.bind(this));\n        \n        fun.net.setGameMsgCfg({});\n        fun.gameCfg.voiceLanguage = cc.sys.localStorage.getItem('voiceLanguage') || fun.gameCfg.voiceLanguage;\n        let valumeData = cc.sys.localStorage.getItem('valumeData');\n        if (valumeData) {\n            valumeData = JSON.parse(valumeData);\n            let s = valumeData.sound, m = valumeData.music;\n            fun.gameCfg.soundValume = (s && s > 0) ? s : (s === 0 ? 0 : 0.8);\n            fun.gameCfg.musicValume = (m && m > 0) ? m : (m === 0 ? 0 : 0.8);\n        }\n\n        this._mainBasic = this.node.getChildByName('mainBasic');\n        this.upNode = this._mainBasic.getChildByName('up');\n        this.renzhengBtn = this.upNode.getChildByName('renzhengBtn');\n        this.renzhengBtn.on('click', this.onRenzhengBtnClick, this);\n        this.head = this.upNode.getChildByName('head');\n        this.head.on('click', this.onHeadClick, this);\n        const userInfo = fun.db.getData('UserInfo');\n        this.showUserInfo(userInfo);\n        if (userInfo.RoomId && userInfo.RoomId !== 0) {\n            this.enterRoom(userInfo.RoomId);\n        } else {\n            if (!this._isIntranet && !this._isTestnet) {\n                let initNode = this.node;\n                setTimeout(function(){\n                    if (!fun.db.getNeedNotice()) {\n                        let notice = initNode.getChildByName('notice');\n                        notice.getComponent(cc.Animation).play('popScaleAnim');\n                        notice.active = true;\n                        fun.db.setNeedNotice(true);\n                        notice.getChildByName('back').getChildByName('btnClose').on('click', function(){\n                            let animState = notice.getComponent(cc.Animation).play('popScaleOut');\n                            animState.once('finished', function () {\n                                notice.active = false;\n                            });\n                        });\n                    }\n                }, 500);\n            }\n        }\n        this.leftNode = this._mainBasic.getChildByName('left');\n        this.leftNode.getChildByName('btnJoin').on('click', this.onBtnJoinClick, this);\n\n        this.gameBtns = [];\n        this.rightNode = this._mainBasic.getChildByName('right');\n        for (let i = 0; i < 4; i++) {\n            this.gameBtns[i] = this.rightNode.getChildByName(\"btnGame\" + (i + 1));\n            this.gameBtns[i].active = true;\n            this.gameBtns[i].on('click', this.onBtnGameClick.bind(this, i));\n        }\n        this.appleReview(); //苹果审核用\n\n        this.gameBtns.push(this.rightNode.getChildByName('btnGameMore'));\n        this.gameBtns[this.gameBtns.length - 1].on('click', this.onBtnGameClick.bind(this, this.gameBtns.length - 1));\n        // this.gameBtns[this.gameBtns.length - 1].on('click', this.onBtnGameMoreClick, this);\n\n        this.buttomNode = this._mainBasic.getChildByName('buttom');\n        this.buttomNode.getChildByName('recordBtn').on('click', this.onRecordBtnClick, this);\n        this.buttomNode.getChildByName('shareBtn').on('click', this.onShareBtnClick, this);\n        this.buttomNode.getChildByName('setBtn').on('click', this.onSetBtnClick, this);\n        this.buttomNode.getChildByName('activeBtn').on('click', this.onActiveBtnClick, this);\n        let newsBtn = this.buttomNode.getChildByName('newsBtn');\n        newsBtn.on('click', this.onNewsBtnClick, this);\n        this.redPoint = newsBtn.getChildByName('redPoint');\n        this.onNewMailIdIn(fun.db.getData('NewMailId'));\n\n        Audio.playMusic('hall', 'BGM-mainUI.mp3');\n        this.node.getChildByName('mainBasic').getChildByName('version').getComponent(cc.Label).string = gameConst.version;\n        fun.event.add('HallUserInfo', 'UserInfo', this.showUserInfo.bind(this));\n        fun.event.add('HallReplayInfo', 'ReplayInfo', this.onReplayInfoIn.bind(this));\n        fun.event.add('HallEnterRoomId', 'EnterRoomId', this.enterRoom.bind(this));\n        fun.event.add('HallNewMailId', 'NewMailId', this.onNewMailIdIn.bind(this));\n\n        let applePayStr = JSON.parse(cc.sys.localStorage.getItem('applePayReceiptStr'));\n        this.onPhonePayResultAck(applePayStr);\n        \n    },\n\n    appleReview () {\n        if(this._isApple){\n            let buttom = this.node.getChildByName('mainBasic').getChildByName('buttom');\n            buttom.getChildByName('recordBtn').setPositionX(-420);\n            buttom.getChildByName('activeBtn').setPositionX(-140);\n            buttom.getChildByName('newsBtn').setPositionX(140);\n            buttom.getChildByName('setBtn').setPositionX(420);\n            buttom.getChildByName('shareBtn').active = false;\n            this.upNode.getChildByName('storeBtn').active = true;\n            this._mainBasic.getChildByName('Songka').active = false;\n\n            this.gameBtns[0].setPositionY(100);\n            this.gameBtns[1].setPositionY(100);\n            this.gameBtns[2].active = false;\n            this.gameBtns[3].active = false;\n            let notice = this.leftNode.getChildByName('Notice');\n            notice.setPositionY(notice.getPositionY() - 70);\n            let btnJoin = this.leftNode.getChildByName('btnJoin');\n            btnJoin.setPosition(cc.p(230, btnJoin.getPositionY() + 50));\n        }\n    },\n\n    onPhonePayResultAck (msg) {\n        if (msg && msg.check) {\n            fun.net.pSend('ApPay', {ReceiptStr: msg.receipt}, function(data){\n                if (data.RetCode && data.RetCode !== 0) {\n                    setTimeout(function(){\n                        this.onPhonePayResultAck(msg);\n                    }.bind(this), 5000);\n                } else {\n                    if (data.Status && data.Status === 1) {\n                        cc.sys.localStorage.setItem('applePayReceiptStr', JSON.stringify({check: false}));\n                    } else {\n                        setTimeout(function(){\n                            this.onPhonePayResultAck(msg);\n                        }.bind(this), 5000);\n                    }\n                }\n            }.bind(this));\n        }\n    },\n\n    addEnterRoomHandle(gameType, handler) {\n        this.enterRoomHandle[gameType] = handler;\n    },\n\n    enterRoom(roomId = 0) {\n        fun.event.dispatch('Zhuanquan', {flag: true, text: '加入房间中，请稍后...'});\n        fun.net.pSend('EnterRoom', {RoomId: roomId, Address: fun.db.getData('UserInfo').location}, function(rsp) {\n            if(rsp.GameType && this.enterRoomHandle[rsp.GameType]){\n                this.enterRoomHandle[rsp.GameType](rsp);\n            }else {\n                fun.event.dispatch('MinSingleButtonPop', {contentStr: gameConst.pRetCode[rsp.RetCode]}); \n                fun.event.dispatch('Zhuanquan', {flag: false});\n            }\n           \n        }.bind(this));\n    },\n\n    platformEnterRoomHandle(data) {\n        fun.event.dispatch('Zhuanquan', {flag: false});\n        switch (data.RetCode) {\n            case 1:\n                fun.event.dispatch('MinSingleButtonPop', {contentStr: '服务器忙'});\n                break;\n            case 13:\n                fun.event.dispatch('MinSingleButtonPop', {contentStr: '房间未找到'});\n        }\n    },\n\n    digFlowerEnterRoomHandle(data) {\n        if (data.returnStatu && data.returnStatu === 1) {\n            fun.db.setData('RoomInfo', data);\n            cc.director.loadScene(gameConst.gameTypeSceneNameMap[data.GameType]);\n        } else {\n            fun.event.dispatch('Zhuanquan', {flag: false});\n        }\n    },\n\n    mahjongEnterRoomHandle(data) {\n        var codeCfg = {}; \n        var mjGameDefine = require(\"mjGameDefine\");\n        if(data.GameType == gameConst.gameType.maJiangHuangYan){\n            codeCfg = mjGameDefine.HYRETCODE;\n        }else if(data.GameType == gameConst.gameType.maJiangWenLing){\n            codeCfg = mjGameDefine.WLRETCODE;\n        }\n        if(!data.RetCode){\n            data.EnterRoom = 'enter';\n            fun.db.setData('RoomInfo', data);\n            cc.director.loadScene(gameConst.gameTypeSceneNameMap[data.GameType]);\n        }else {\n            var self = this;\n            //房卡不足，跳转商店\n            if(data.RetCode == 19){\n                var gotoStore= function(){\n                    self.showStore(data.GameType);\n                };\n                fun.event.dispatch('MinSingleButtonPop', {contentStr: codeCfg[data.RetCode], okBtnStr:\"前往充值\", okCb: gotoStore});\n            }else {\n                fun.event.dispatch('MinSingleButtonPop', {contentStr: codeCfg[data.RetCode]});\n            }\n            fun.event.dispatch('Zhuanquan', {flag: false});\n        }\n    },\n\n    showStore(gameType){\n        let isApple = fun.gameCfg.releaseType === gameConst.releaseType.apple ? true : false;\n        let isIntranet = fun.gameCfg.loginUrl === gameConst.loginUrl[gameConst.loginUrlType.intranet] ? true : false;\n        if(isApple || isIntranet){\n            let store = cc.instantiate(this.storePre);\n            store.parent = this.node;\n            store.getComponent('store').setGameType(gameType);\n        } else {\n            fun.event.dispatch('MinSingleButtonPop', {contentStr: '公测期间，免费畅玩！'});\n        }\n    },\n\n    onRenzhengBtnClick () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        if(this._isApple){\n            fun.event.dispatch('MinSingleButtonPop', {contentStr: '敬请期待！'});\n        }\n        return;\n        let renzheng = cc.instantiate(this.renzhengPre);\n        renzheng.parent = this.node;\n    },\n\n    onHeadClick () {\n        \n    },\n\n    showUserInfo (data) {\n        this.head.getChildByName('nickname').getComponent(cc.Label).string = data.UserName;\n        this.head.getChildByName('userid').getComponent(cc.Label).string = data.UserId;\n        fun.utils.loadUrlRes(data.UserHeadUrl, this.head.getChildByName('border'));\n    },\n\n    onReplayInfoIn(data) {\n        data.record = JSON.parse(fun.base64.decode(data.record));\n        switch (data.gameType) {\n            case gameConst.gameType.maJiangWenLing:\n                require(\"mjReplayMgr\").setReplayData(gameConst.gameType.maJiangWenLing, data)\n                break;\n            case gameConst.gameType.maJiangHuangYan:\n                require(\"mjReplayMgr\").setReplayData(gameConst.gameType.maJiangHuangYan, data)\n                break;\n        }\n    },\n\n    onNewMailIdIn(mId) {\n        this.redPoint.active = mId > 0;\n    },\n\n    onBtnGameClick (index) {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        switch (index) {\n            case 0:\n                fun.net.pSend('RoomCard', {GameType: gameConst.gameType.maJiangHuangYan}, function(data) {\n                    if (data.Total !== undefined) {\n                        var hyNode = cc.instantiate(this.createMajiangRoomHY);\n                        hyNode.parent = this.node;\n                        hyNode.getComponent('createMajiangRoom').showRoomCard(data.Total);\n                    }\n                }.bind(this));    \n                break;\n            case 1:\n                fun.net.pSend('RoomCard', {GameType: gameConst.gameType.maJiangWenLing}, function(data) {\n                    if (data.Total !== undefined) {\n                        var wlNode = cc.instantiate(this.createMajiangRoomWL);\n                        wlNode.parent = this.node;\n                        wlNode.getComponent('createMajiangRoom').showRoomCard(data.Total);\n                    }\n                }.bind(this));\n                break;\n            case 2:\n                // fun.event.dispatch('MinSingleButtonPop', {contentStr: '敬请期待！'});\n                // return;\n                let nnNode = cc.instantiate(this.createRoomWahua);\n                nnNode.parent = this.node;\n                break;\n            case 3:\n                fun.event.dispatch('MinSingleButtonPop', {contentStr: '敬请期待！'});\n                return;\n                let sgNode = cc.instantiate(this.createSanGongRoomPre);\n                sgNode.parent = this.node;\n                break;\n        }\n    },\n\n    onBtnGameMoreClick () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        fun.event.dispatch('MinSingleButtonPop', {contentStr: '敬请期待！'});\n        return;\n        let gameMore = cc.instantiate(this.moreGamePre);\n        gameMore.parent = this.node;\n    },\n\n    onRecordBtnClick() {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        const gameType = gameConst.gameType.maJiangHuangYan;\n        fun.net.pSend('StandingBrief', {GameType: gameType, Start: 0}, function(data) {\n            let zhanjiLayer = cc.instantiate(this.zhanjiLayerPre);\n            zhanjiLayer.parent = this.node;\n            zhanjiLayer.getComponent('zhanjiLayer').init(gameType, data);\n        }.bind(this));\n    },\n\n    onShareBtnClick() {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        fun.net.pSend('GoodCnt', {Type: gameConst.itemCsv.voucher}, function(data){\n            if(data.RetCode && data.RetCode !== 0){\n                fun.event.dispatch('MinSingleButtonPop', {contentStr: '查询兑换券失败!'});\n                return;\n            }\n            let hallShare = cc.instantiate(this.hallSharePre);\n            hallShare.parent = this.node;\n            hallShare.getComponent('hallShare').setLeftTicket(data.Cnt);\n        }.bind(this));\n    },\n\n    onNewsBtnClick() {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        if (this._isApple) {\n            let news = cc.instantiate(this.newsLayerPre);\n            news.parent = this.node;\n        } else {\n            fun.net.pSend('MailList', {Page: 0, Count: 10}, function (rsp) {\n                fun.db.setData('NewMailId', false);\n                let news = cc.instantiate(this.newsLayerPre);\n                news.parent = this.node;\n                news.getComponent('mailLayer').init(10, rsp.mInfos);\n            }.bind(this));\n        }\n    },\n\n    onSetBtnClick () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        let setPanel = cc.instantiate(this.setPanelPre);\n        setPanel.parent = this.node;\n    },\n\n    onActiveBtnClick () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        let activity = cc.instantiate(this.activityPre);\n        activity.parent = this.node;\n    },\n\n    onBtnJoinClick () {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        let enter = this.node.getChildByName('enterRoom');\n        enter.active = true;\n        enter.x = 0;\n        enter.y = 0;\n    },\n\n    onStoreBtnClick() {\n        Audio.playEffect('hall', 'button_nomal.mp3');\n        let store = cc.instantiate(this.storePre);\n        store.parent = this.node;\n    },\n\n    onDestroy () {\n        fun.event.remove('HallUserInfo');\n        fun.event.remove('HallReplayInfo');\n        fun.event.remove('HallEnterRoomId');\n        fun.event.remove('HallNewMailId');\n        Audio.stopMusic();\n    },\n\n});\n"]}
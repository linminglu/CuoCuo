{"version":3,"sources":["../../../../../../../assets/mahjong/script/ui/prefab/assets/mahjong/script/ui/prefab/mjPaiUI.js"],"names":["log","cc","normalColor","Color","caiShengColor","chooseColor","GameDefine","require","mjDataMgr","Class","extends","Component","properties","paiAltas","SpriteAtlas","pai3dAltas","init","paiInfo","shouN","node","getChildByName","pengN","pengByN","endN","gaiN","gaiShouN","newTagN","effectZoneN","_norScale","get","KEYS","CFG","paiScale","curScale","scale","ShowType","PAISHOWTYPE","nodeList","PENGBY","PENG","SHOU","END","GAI","SHOUGAI","TypeNodeList","initPaiSprite","pai","refreshPaiNode","item","contentN","getComponent","Sprite","spriteFrame","getPaiSprite","getLocalId","skewX","skewY","sfScale","contentPos","setPosition","caishengN","caishen3DN","active","isCaiShen","is3DView","bgN","color","isMagic","bgFrameName","sf","getSpriteByInfo","getSpriteFrame","width","getRect","height","paiID","spriteName","refresh","hideAll","curPaiNode","showType","isChuPai","curBgColor","type","showSamePaiTips","isChoose","id","curBgNode","addEffect","effNode","huTag","addChild","setPengBgColor"],"mappings":"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","file":"mjPaiUI.js","sourceRoot":"../../../../../../../assets/mahjong/script/ui/prefab","sourcesContent":["// var utils         = require(\"utils\");\nvar log           = cc.log;\nvar normalColor   = new cc.Color(255, 255, 255);\nvar caiShengColor = new cc.Color(233, 217, 177);\nvar chooseColor   = new cc.Color(255, 185, 249);\nvar GameDefine    = require(\"mjGameDefine\");\nvar mjDataMgr     = require(\"mjDataMgr\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        paiAltas : cc.SpriteAtlas,\n        pai3dAltas : cc.SpriteAtlas,\n    },\n\n    // use this for initialization\n\n    init : function (paiInfo = {}) {\n        // if(this.shouN){return}\n        this.shouN       = this.node.getChildByName(\"shou\");\n        this.pengN       = this.node.getChildByName(\"peng\");\n        this.pengByN     = this.node.getChildByName(\"pengBy\");\n        this.endN        = this.node.getChildByName(\"end\");\n        this.gaiN        = this.node.getChildByName(\"gai\")\n        this.gaiShouN    = this.node.getChildByName(\"gaiShou\");\n        this.newTagN     = this.node.getChildByName(\"newTag\");\n        this.effectZoneN = this.node.getChildByName(\"effect\");\n        \n        var  _norScale      = mjDataMgr.get(mjDataMgr.KEYS.CFG).paiScale || 1;\n        var  paiScale       = paiInfo.curScale || _norScale;\n        this.node.scale     = paiScale;\n        // this.shouN.scale    = paiScale;\n        // this.pengN.scale    = paiScale;\n        // this.pengByN.scale  = paiScale;\n        // this.gaiShouN.scale = paiScale;\n        // this.gaiN.scale     = paiScale;\n        var ShowType               = GameDefine.PAISHOWTYPE;\n        var nodeList               = {}\n        nodeList[ShowType.PENGBY]  = this.pengByN;\n        nodeList[ShowType.PENG]    = this.pengN;\n        nodeList[ShowType.SHOU]    = this.shouN;\n        nodeList[ShowType.END]     = this.endN;\n        nodeList[ShowType.GAI]     = this.gaiN;\n        nodeList[ShowType.SHOUGAI] = this.gaiShouN;\n        this.TypeNodeList          = nodeList;\n\n\n    },\n\n    initPaiSprite : function(pai){\n        // this.init()\n        // this.setContentSpite(this.shouN, pai);\n        // this.setContentSpite(this.pengN, pai);\n        // this.setContentSpite(this.endN, pai);\n        // this.setContentSpite(this.pengByN, pai);\n        // this.refresh(pai);\n    },\n\n    // setContentSpite: function(fNode, pai){\n    //     this.pai = pai;\n    //     this.refreshPaiNode(fNode, pai)\n    // },\n\n    refreshPaiNode: function(item, pai, paiInfo = {}){\n        let contentN = item.getChildByName(\"content\");\n        if(contentN){\n            contentN.getComponent(cc.Sprite).spriteFrame = this.getPaiSprite(pai.getLocalId()); //pai.paiSprite;\n            contentN.skewX = paiInfo.skewX || 0;\n            contentN.skewY = paiInfo.skewY || 0;\n            contentN.scale = paiInfo.sfScale || 1;\n            if(paiInfo.contentPos){\n                contentN.setPosition(paiInfo.contentPos);\n            }\n        }\n        let caishengN = item.getChildByName(\"caisheng\")\n        let caishen3DN    = item.getChildByName(\"caisheng3d\");\n        if(caishengN){\n            caishengN.active = pai.isCaiShen && !paiInfo.is3DView;\n        }\n        if(caishen3DN) {\n            caishen3DN.active   = pai.isCaiShen && paiInfo.is3DView;\n        }\n        var bgN = item.getChildByName(\"bg\")\n        if(bgN){\n            bgN.color = pai.isMagic ? caiShengColor : normalColor\n            if(paiInfo.bgFrameName){\n                var sf = this.getSpriteByInfo(paiInfo).getSpriteFrame(paiInfo.bgFrameName);\n                bgN.getComponent(cc.Sprite).spriteFrame = sf;\n                bgN.width = sf.getRect().width;\n                bgN.height = sf.getRect().height;\n            }\n        }\n    }, \n\n    getPaiSprite : function(paiID){\n        // var mjDataMgr = require(\"mjDataMgr\")\n        var spriteName  = \"pj_\"+ paiID//mjDataMgr.getInstance().getLocalPaiID(paiID);\n        var spriteFrame = this.paiAltas.getSpriteFrame(spriteName);\n        return spriteFrame;\n    },\n\n    refresh : function(pai, paiInfo){\n        this.init(paiInfo);\n        this.pai = pai;\n        this.hideAll();\n        this.curPaiNode        = this.TypeNodeList[pai.showType];\n        this.curPaiNode.active = true;\n        this.refreshPaiNode(this.curPaiNode, pai, paiInfo);\n        this.newTagN.active = pai.isChuPai;\n        this.curBgColor= pai.isMagic ? caiShengColor : normalColor\n    },\n\n    hideAll(){\n        for(let type in this.TypeNodeList){\n            this.TypeNodeList[type].active = false;\n        }\n    },\n\n    showSamePaiTips : function(paiID){\n        var isChoose = (paiID == this.pai.id);\n        var curBgNode = this.curPaiNode.getChildByName(\"bg\");\n        if(curBgNode){\n            curBgNode.color = isChoose ? chooseColor : this.curBgColor\n        }\n        \n    },\n\n    addEffect : function(effNode, huTag){\n        this.effectZoneN.active = true;\n        if(huTag == \"dp\"){\n            this.effectZoneN.getChildByName(\"dp\").addChild(effNode)\n        }else if (huTag == \"hu\") {\n            this.effectZoneN.getChildByName(\"hu\").addChild(effNode)\n        }\n        \n    },\n\n    setPengBgColor : function(color){\n        if(this.curPaiNode.getChildByName(\"bg\")){\n            this.curPaiNode.getChildByName(\"bg\").color = color;\n        }\n    },\n\n    getSpriteByInfo(paiInfo){\n        if(!paiInfo.is3DView){\n            return this.paiAltas\n        }else{\n            return this.pai3dAltas;\n        }\n    },\n\n\n});\n"]}
{"version":3,"sources":["../../../../assets/phone/assets/phone/JSPhoneVoice.js"],"names":["className","voice","startAudio","name","filepath","cc","path","join","getVoicePath","sys","os","OS_ANDROID","jsb","reflection","callStaticMethod","OS_IOS","stopAudio","playAudio","isNative","fileUtils","isFileExist","console","log","getVoiceDataByName","fileName","voiceData","getDataFromFile","fun","base64","fromByteArray","writeVoiceData","data","toByteArray","writeDataToFile","getWritablePath","clearOldVoice","dirpath","isDirectoryExist","removeDirectory","createDirectory","module","exports"],"mappings":"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","file":"JSPhoneVoice.js","sourceRoot":"../../../../assets/phone","sourcesContent":["const className = 'org/cocos2dx/javascript/AppActivity';\n\nlet voice = {\n\n    startAudio : function(name){\n        const filepath = cc.path.join(this.getVoicePath(), name);\n        if(cc.sys.os === cc.sys.OS_ANDROID)\n            jsb.reflection.callStaticMethod(className, 'startAudio', '(Ljava/lang/String;)V', filepath);\n        else if(cc.sys.os === cc.sys.OS_IOS)\n            jsb.reflection.callStaticMethod('OCPhoneAudio', 'startAudio:', filepath);\n    },\n\n    stopAudio : function(){\n        if(cc.sys.os === cc.sys.OS_ANDROID)\n            jsb.reflection.callStaticMethod(className, 'stopAudio', '()V');\n        else if(cc.sys.os === cc.sys.OS_IOS)\n            jsb.reflection.callStaticMethod('OCPhoneAudio', 'stopAudio');\n    },\n\n    playAudio : function(name){\n        if(!cc.sys.isNative){return}\n        const filepath = cc.path.join(this.getVoicePath(), name);\n        if(!jsb.fileUtils.isFileExist(filepath+'.mp3')){\n            console.log('---* js. voice file not exist. *---');\n            return;\n        }\n        if(cc.sys.os === cc.sys.OS_ANDROID)\n            jsb.reflection.callStaticMethod(className, 'playAudio', '(Ljava/lang/String;)V', filepath);\n        else if(cc.sys.os === cc.sys.OS_IOS)\n            jsb.reflection.callStaticMethod('OCPhoneAudio', 'playAudio:', filepath);\n    },\n\n    getVoiceDataByName : function (name) {\n        if(!cc.sys.isNative){return}\n        const fileName = cc.path.join(this.getVoicePath(), name + '.mp3');\n        if (!jsb.fileUtils.isFileExist(fileName)) {\n            console.log('---* js. voice file not exist. *---');\n            return null;\n        }\n        let voiceData = jsb.fileUtils.getDataFromFile(fileName);\n        return fun.base64.fromByteArray(voiceData);\n    },\n\n    writeVoiceData : function(data, name) {\n        if(!cc.sys.isNative){return}\n        const fileName = cc.path.join(this.getVoicePath(), name + '.mp3');\n        let voiceData = fun.base64.toByteArray(data);\n        jsb.fileUtils.writeDataToFile(voiceData, fileName);\n    },\n\n    getVoicePath : function(){\n        if(!cc.sys.isNative){return}\n        return cc.path.join(jsb.fileUtils.getWritablePath(), 'VoiceChatPath/');\n    },\n\n    clearOldVoice : function () {\n        if(!cc.sys.isNative){return}\n        const dirpath = cc.path.join(jsb.fileUtils.getWritablePath(), 'VoiceChatPath/');\n        if (jsb.fileUtils.isDirectoryExist(dirpath)) {\n            jsb.fileUtils.removeDirectory(dirpath);\n        }\n        jsb.fileUtils.createDirectory(dirpath);\n    },\n}\n\nmodule.exports = voice;"]}